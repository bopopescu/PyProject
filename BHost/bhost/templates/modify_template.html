<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <title>manager</title>
    <link rel="stylesheet" href="/manage/skin/icheck/minimal/blue.css">
    <link rel="stylesheet" href="/manage/css/select2.min.css">
    <link rel="stylesheet" href="/manage/css/style.css">
	<link rel="stylesheet" href="/manage/css/new-head.css"> 
</head>

<body style="overflow:hidden;min-width: 800px" class="bg-white">
    <div class="mainer">
        <div class="container">
            <div class="c-top">
                <div class="c-title">
					<!--
                    <div class="tit-nav">
                        <h3 class="tit"><span>修改模板</span><i class="icon-edit"></i></h3>
                    </div>
					-->
					<div class="manual-head" style="width:123px;;float:left;">
						<div class="manual-title-other title-item" id="frist" style="background-color: rgba(27, 1, 1, 0);">
						{% if temp_id == '0' %}
							<span class="modify_icon" style="">添加模板</span>
						{% else %}
							<span class="modify_icon" style="">修改模板</span>
						{% endif %}
							<i class="pwd_change_icon" style=""></i>
						</div>
					</div>
                    <div class="tit-step" style="margin-left: 10px;">
                        <ul>
                            <li class="active">基本信息</li>
                            <li>报表条件</li>
                            <li>报表内容</li>
                            <li style="display: none;">扩展报表</li>
                        </ul>
                    </div>
                    <div class="bb-tit-ctr">
						<!--
                        <a href="javascript:;" title="添加分类" onclick="parent._addClassify()"><i class="icon1"></i></a>
                        <a href="javascript:;" title="添加模板" onclick="parent._addModel()"><i class="icon2"></i></a>
						-->
                        <a href="javascript:;" title="报表素材" onclick="parent._globalSetting()"><i class="icon3"></i>报表素材</a>
                    </div>
                </div>
            </div>
            <div class="bb-cont" id="bbCont">
                <div id="Step1">
                    <div class="bb-box">
                        <div class="bitem bitem-t">
                            <div class="label">
                                报表名称：
                            </div>
                            <div class="bc">
                                <input class="texin" type="text" name="RptName" id="RptName" value="" style="width: 350px" maxlength="50">
                                <p class="tip"><i></i>不超过50个字符，仅支持中文、字母、数字</p>
                            </div>
                            <div class="bfix"></div>
                            <div class="label">
                                所属分类：
                            </div>
                            <div class="bc">
                                <select name="daleibox" id="daleibox" class="bb-select" style="width:12em">
									<!--
                                    <option value="1">远程控制</option>
									-->
                                </select>
                            </div>
                        </div>
                        <div class="bitem">
                            <div class="label">
                                报表描述：
                            </div>
                            <div class="bc">
                                <textarea name="RptMemo" id="RptMemo" cols="30" rows="10" maxlength="120"></textarea>
                            </div>
                        </div>
                        <div class="bitem">
                            <div class="label">
                                建    议：
                            </div>
                            <div class="bc">
                                <textarea name="RptSugg" id="RptSugg" cols="30" rows="10" maxlength="120"></textarea>
                            </div>
                        </div>
                        <div class="bitem">
                            <div class="label">
                                生成格式：
                            </div>
                            <div class="bc">
                                <select name="DataFormat" id="DataFormat" class="bb-select" style="width:8em">
                                    <option value="未指定">未指定</option>
                                    <option value="HTML">HTML</option>
                                    <option value="DOC">DOC</option>
									<option value="PDF">PDF</option>
									<option value="RTF">RTF</option>
									<option value="XLS">XLS</option>
                                </select>
                            </div>
                        </div>
                        <div class="bitem">
                            <div class="label">
                                加载模块：
                            </div>
                            <div class="bc">
                                <select name="RptLoad" id="RptLoad" class="bb-select" style="width:8em">
                                    <option value="默认">默认</option>
									<!--
                                    <option value="指定">指定</option>
                                    <option value="指定1">指定1</option>
                                    <option value="指定2">指定2</option>
									-->
                                </select>
                            </div>
                        </div>
                        <div class="bitem">
                            <div class="label" id="graphic_report">
                                图形报表：
                            </div>
                            <div class="bc">
                                <input class="forSwitch" type="checkbox" name="renwuopen" id="renwuopen" data-text="生成|不生成" checked>
                            </div>
                        </div>
                        <div class="bitem">
                            <div class="label" id="text_report">
                                文字报表：
                            </div>
                            <div class="bc">
                                <input class="forSwitch" type="checkbox" name="renwuopen" id="renwuopen" data-text="生成|不生成" checked>
                            </div>
                        </div>
                    </div>
                </div>
                <!---->
                <div id="Step2" style="display: none;">
                    <div class="bb-box">
                        <div class="bitem bitem-t">
                            <div class="label">
                                日志属性：
                            </div>
                            <div class="bc" id="log_attribute">
                                <label>
                                    <input class="bb-checkbox" type="checkbox" name="" id="CheckType1" value="1" checked>操作</label>
                                <label>
                                    <input class="bb-checkbox" type="checkbox" name="" id="CheckType2" value="2">会话</label>
                                <label>
                                    <input class="bb-checkbox" type="checkbox" name="" id="CheckType3" value="3">系统</label>
                            </div>
                        </div>
                        <div class="bitem bitem-tab">
                            <table cellspacing="0" cellpadding="0">
                                <thead>
                                    <tr>
                                        <th width="90" style="text-align: right;">字段</th>
                                        <th width="100">选项</th>
                                        <th width="100">操作</th>
                                        <th>值</th>
                                    </tr>
                                </thead>
                                <tbody id="trList">
                                    <tr data-type="string" data-check='1,2,3' field="0" index="0">
                                        <td style="text-align: right;">编号：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
                                                    <option value="equal">=</option>
                                                    <option value="between">区间</option>
                                                    <option value="high">&gt;</option>
                                                    <option value="ehigh">&gt;=</option>
                                                    <option value="low">&lt;</option>
													<option value="elow">&lt;=</option>
                                                    <option value="not equal">不等于</option>
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont" id="all_values">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr data-type="time" data-check='1,2,3' field="0" index="1">
                                        <td style="text-align: right;">入库时间：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
												<!--
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
												-->
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
											<!--
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
                                                    <option value="between">闭区间</option>
                                                    <option value="span">开区间</option>
                                                    <option value="ehspan">左开右闭</option>
                                                    <option value="elspan">左闭右开</option>
                                                    <option value="equal">=</option>
                                                    <option value="ehigh">&gt;=</option>
                                                    <option value="elow">&lt;=</option>
                                                </select>
                                            </div>
											-->
                                        </td>
                                        <td>
											<!--
                                            <div class="bb-sel-cont">
                                            </div>
											-->
                                        </td>
                                    </tr>
                                    <tr data-type="time" data-check='1,2,3' field="0" index="2">
                                        <td style="text-align: right;">发生时间：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
                                                    <option value="between">区间</option>
													<!--
                                                    <option value="span">开区间</option>
                                                    <option value="ehspan">左开右闭</option>
                                                    <option value="elspan">左闭右开</option>
													-->
                                                    <option value="equal">=</option>
                                                    <option value="ehigh">&gt;=</option>
                                                    <option value="elow">&lt;=</option>
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont srItem">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr data-type="string" data-check='1,2' field="0" index="3">
                                        <td style="text-align: right;">会话标识：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
                                                    <option value="equal">=</option>
                                                    <option value="between">区间</option>
                                                    <option value="high">&gt;</option>
                                                    <option value="ehigh">&gt;=</option>
                                                    <option value="low">&lt;</option>
													<option value="elow">&lt;=</option>
                                                    <option value="not equal">不等于</option>
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr data-type="time" data-check='1,2' field="0" index="4">
                                        <td style="text-align: right;">起始时间：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
                                                    <option value="between">区间</option>
													<!--
                                                    <option value="span">开区间</option>
                                                    <option value="ehspan">左开右闭</option>
                                                    <option value="elspan">左闭右开</option>
													-->
                                                    <option value="equal">=</option>
                                                    <option value="ehigh">&gt;=</option>
                                                    <option value="elow">&lt;=</option>
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont srItem">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr data-type="time" data-check='2' field="0" index="5">
                                        <td style="text-align: right;">结束时间：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
                                                    <option value="between">区间</option>
													<!--
                                                    <option value="span">开区间</option>
                                                    <option value="ehspan">左开右闭</option>
                                                    <option value="elspan">左闭右开</option>
													-->
                                                    <option value="equal">=</option>
                                                    <option value="ehigh">&gt;=</option>
                                                    <option value="elow">&lt;=</option>
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont srItem">
                                            </div>
                                        </td>
                                    </tr>
									<!--
                                    <tr data-type="number" data-check='1,2,3' field="3" index="1">
                                        <td style="text-align: right;">日志属性：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
                                                    <option value="equal">=</option>
                                                    <option value="between">闭区间</option>
                                                    <option value="span">开区间</option>
                                                    <option value="ehspan">左开右闭</option>
                                                    <option value="elspan">左闭右开</option>
                                                    <option value="high">&gt;</option>
                                                    <option value="ehigh">&gt;=</option>
                                                    <option value="low">&lt;</option>
                                                    <option value="not equal">不等于</option>
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont">
                                            </div>
                                        </td>
                                    </tr>
									-->
                                    <tr data-type="number" data-check='2' field="1" index="3">
                                        <td style="text-align: right;">会话状态：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
                                                    <option value="equal">=</option>
                                                    <option value="between">区间</option>
                                                    <option value="high">&gt;</option>
                                                    <option value="ehigh">&gt;=</option>
                                                    <option value="low">&lt;</option>
                                                    <option value="not equal">不等于</option>
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr data-type="select" data-select="gjcl" data-check='1,2,3' field="1" index="11">
                                        <td style="text-align: right;">告警处理：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
											<div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
                                                    <option value="equal">等于</option>
                                                    <option value="not equal">不等于</option>
                                                </select>
                                            </div>
											<!--
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
                                                    <option value="equal">=</option>
                                                    <option value="between">闭区间</option>
                                                    <option value="span">开区间</option>
                                                    <option value="ehspan">左开右闭</option>
                                                    <option value="elspan">左闭右开</option>
                                                    <option value="high">&gt;</option>
                                                    <option value="ehigh">&gt;=</option>
                                                    <option value="low">&lt;</option>
                                                    <option value="not equal">不等于</option>
                                                </select>
                                            </div>
											-->
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr data-type="select" data-select="gjlx" data-check='1,2' field="1" index="14">
                                        <td style="text-align: right;">告警类型：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
                                                    <option value="equal">等于</option>
                                                    <option value="not equal">不等于</option>
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr data-type="select" data-select="gjdj" data-check='1,2' field="1" index="15">
                                        <td style="text-align: right;">告警等级：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
                                                    <option value="equal">等于</option>
                                                    <option value="not equal">不等于</option>
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr data-type="number" data-check='1,2' field="2" index="0">
                                        <td style="text-align: right;">客户端端口：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
                                                    <option value="equal">=</option>
                                                    <option value="between">区间</option>
                                                    <option value="high">&gt;</option>
                                                    <option value="ehigh">&gt;=</option>
                                                    <option value="low">&lt;</option>
													<option value="elow">&lt;=</option>
                                                    <option value="not equal">不等于</option>
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr data-type="number" data-check='1,2' field="2" index="1">
                                        <td style="text-align: right;">服务器端口：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
                                                    <option value="equal">=</option>
                                                    <option value="between">区间</option>
                                                    <option value="high">&gt;</option>
                                                    <option value="ehigh">&gt;=</option>
                                                    <option value="low">&lt;</option>
													<option value="elow">&lt;=</option>
                                                    <option value="not equal">不等于</option>
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr data-type="select" data-select="rzlx" data-check='1,2' field="3" index="1">
                                        <td style="text-align: right;">协议：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
                                                    <option value="equal">等于</option>
                                                    <option value="not equal">不等于</option>
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr data-type="ip" data-check='1,2,3' field="4" index="0">
                                        <td style="text-align: right;">发生地址：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
													<option value="equal">等于</option>
                                                    <option value="between">区间</option>
													<option value="not equal">不等于</option>
													<option value="ingroup">主机组</option>
													<!--
                                                    <option value="equal">=</option>
                                                    <option value="between">闭区间</option>
                                                    <option value="span">开区间</option>
                                                    <option value="ehspan">左开右闭</option>
                                                    <option value="elspan">左闭右开</option>
                                                    <option value="high">&gt;</option>
                                                    <option value="ehigh">&gt;=</option>
                                                    <option value="low">&lt;</option>
                                                    <option value="not equal">不等于</option>
													-->
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont">
                                            </div>
                                        </td>
                                    </tr>
									<tr data-type="string" data-check='3' field="6" index="22">
                                        <td style="text-align: right;">运维用户：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
													<option title="包含" value="include">包含</option>
                                                    <option title="不包含" value="not include">不包含</option>
                                                    <option title="开始" value="begin">开始</option>
                                                    <option title="结束" value="end">结束</option>
													<option title="正则匹配" value="regx">正则匹配</option>
													<option title="正则不匹配" value="not regx">正则不匹配</option>
													<option title="正则匹配（忽略大小写）" value="ncregx">正则匹配（忽略大小写）</option>
													<option title="正则不匹配（区分大小写）" value="not ncregx">正则不匹配（区分大小写）</option>
													<option title="通配符" value="match">通配符</option>
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont">
                                            </div>
                                        </td>
                                    </tr>
									<tr data-type="string" data-check='3' field="6" index="1">
                                        <td style="text-align: right;">日志操作：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
													<option title="包含" value="include">包含</option>
                                                    <option title="不包含" value="not include">不包含</option>
                                                    <option title="开始" value="begin">开始</option>
                                                    <option title="结束" value="end">结束</option>
													<option title="正则匹配" value="regx">正则匹配</option>
													<option title="正则不匹配" value="not regx">正则不匹配</option>
													<option title="正则匹配（忽略大小写）" value="ncregx">正则匹配（忽略大小写）</option>
													<option title="正则不匹配（区分大小写）" value="not ncregx">正则不匹配（区分大小写）</option>
													<option title="通配符" value="match">通配符</option>
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr data-type="string" data-check='3' field="6" index="2">
                                        <td style="text-align: right;">结果信息：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
													<option title="包含" value="include">包含</option>
                                                    <option title="不包含" value="not include">不包含</option>
                                                    <option title="开始" value="begin">开始</option>
                                                    <option title="结束" value="end">结束</option>
													<option title="正则匹配" value="regx">正则匹配</option>
													<option title="正则不匹配" value="not regx">正则不匹配</option>
													<option title="正则匹配（忽略大小写）" value="ncregx">正则匹配（忽略大小写）</option>
													<option title="正则不匹配（区分大小写）" value="not ncregx">正则不匹配（区分大小写）</option>
													<option title="通配符" value="match">通配符</option>
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont">
                                            </div>
                                        </td>
                                    </tr>
									<tr data-type="string" data-check='3' field="6" index="4">
                                        <td style="text-align: right;">模块：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
													<option title="包含" value="include">包含</option>
                                                    <option title="不包含" value="not include">不包含</option>
                                                    <option title="开始" value="begin">开始</option>
                                                    <option title="结束" value="end">结束</option>
													<option title="正则匹配" value="regx">正则匹配</option>
													<option title="正则不匹配" value="not regx">正则不匹配</option>
													<option title="正则匹配（忽略大小写）" value="ncregx">正则匹配（忽略大小写）</option>
													<option title="正则不匹配（区分大小写）" value="not ncregx">正则不匹配（区分大小写）</option>
													<option title="通配符" value="match">通配符</option>
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont">
                                            </div>
                                        </td>
                                    </tr>
									
									<tr data-type="select" data-check='3' data-select="sfgj" field="1" index="12">
                                        <td style="text-align: right;">是否告警：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
													<option title="等于" value="equal">等于</option>
                                                    <option title="不等于" value="not equal">不等于</option>
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont">
                                            </div>
                                        </td>
                                    </tr>
									
									<tr data-type="string" data-check='3' field="6" index="30">
                                        <td style="text-align: right;">告警信息：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
													<option title="包含" value="include">包含</option>
                                                    <option title="不包含" value="not include">不包含</option>
                                                    <option title="开始" value="begin">开始</option>
                                                    <option title="结束" value="end">结束</option>
													<option title="正则匹配" value="regx">正则匹配</option>
													<option title="正则不匹配" value="not regx">正则不匹配</option>
													<option title="正则匹配（忽略大小写）" value="ncregx">正则匹配（忽略大小写）</option>
													<option title="正则不匹配（区分大小写）" value="not ncregx">正则不匹配（区分大小写）</option>
													<option title="通配符" value="match">通配符</option>
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont">
                                            </div>
                                        </td>
                                    </tr>
									
                                    <tr data-type="ip" data-check='1,2' field="4" index="1">
                                        <td style="text-align: right;">服务端地址：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
													<option value="equal">等于</option>
                                                    <option value="between">区间</option>
													<option value="not equal">不等于</option>
													<option value="ingroup">主机组</option>
													<!--
                                                    <option value="equal">=</option>
                                                    <option value="between">闭区间</option>
                                                    <option value="span">开区间</option>
                                                    <option value="ehspan">左开右闭</option>
                                                    <option value="elspan">左闭右开</option>
                                                    <option value="high">&gt;</option>
                                                    <option value="ehigh">&gt;=</option>
                                                    <option value="low">&lt;</option>
                                                    <option value="not equal">不等于</option>
													-->
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr data-type="ip" data-check='1,2' field="4" index="2">
                                        <td style="text-align: right;">客户端地址：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
													<option value="equal">等于</option>
                                                    <option value="between">区间</option>
													<option value="not equal">不等于</option>
													<option value="ingroup">主机组</option>
													<!--
                                                    <option value="equal">=</option>
                                                    <option value="between">闭区间</option>
                                                    <option value="span">开区间</option>
                                                    <option value="ehspan">左开右闭</option>
                                                    <option value="elspan">左闭右开</option>
                                                    <option value="high">&gt;</option>
                                                    <option value="ehigh">&gt;=</option>
                                                    <option value="low">&lt;</option>
                                                    <option value="not equal">不等于</option>
													-->
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr data-type="number" data-check='2' field="5" index="2">
                                        <td style="text-align: right;">操作个数：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
                                                    <option value="equal">=</option>
                                                    <option value="between">区间</option>
                                                    <option value="high">&gt;</option>
                                                    <option value="ehigh">&gt;=</option>
                                                    <option value="low">&lt;</option>
                                                    <option value="not equal">不等于</option>
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr data-type="number" data-check='2' field="5" index="14">
                                        <td style="text-align: right;">文件大小：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
                                                    <option value="equal">=</option>
                                                    <option value="between">区间</option>
                                                    <option value="high">&gt;</option>
                                                    <option value="ehigh">&gt;=</option>
                                                    <option value="low">&lt;</option>
                                                    <option value="not equal">不等于</option>
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr data-type="select" data-select="gjdz" data-check='1,2' field="5" index="15">
                                        <td style="text-align: right;">告警动作：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
											<div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
                                                    <option value="equal">等于</option>
													<option value="not equal">不等于</option>
													<option value="include">包含</option>
													<option value="not include">不包含</option>
                                                </select>
                                            </div>
											<!--
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
													<option title="包含" value="include">包含</option>
                                                    <option title="不包含" value="not include">不包含</option>
                                                    <option title="开始" value="begin">开始</option>
                                                    <option title="结束" value="end">结束</option>
													<option title="正则匹配" value="regx">正则匹配</option>
													<option title="正则不匹配" value="not regx">正则不匹配</option>
													<option title="正则匹配（忽略大小写）" value="ncregx">正则匹配（忽略大小写）</option>
													<option title="正则不匹配（区分大小写）" value="not ncregx">正则不匹配（区分大小写）</option>
													<option title="通配符" value="match">通配符</option>
                                                </select>
                                            </div>
											-->
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr data-type="string" data-check='1,2' field="6" index="0">
                                        <td style="text-align: right;">服务器用户：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
													<!--
                                                    <option value="equal">等于</option>
													-->
													<option title="包含" value="include">包含</option>
                                                    <option title="不包含" value="not include">不包含</option>
                                                    <option title="开始" value="begin">开始</option>
                                                    <option title="结束" value="end">结束</option>
													<option title="正则匹配" value="regx">正则匹配</option>
													<option title="正则不匹配" value="not regx">正则不匹配</option>
													<option title="正则匹配（忽略大小写）" value="ncregx">正则匹配（忽略大小写）</option>
													<option title="正则不匹配（区分大小写）" value="not ncregx">正则不匹配（区分大小写）</option>
													<option title="通配符" value="match">通配符</option>				
													<!--
                                                    <option value="regx">正则表达式</option>
                                                    <option value="match">通配符</option>
													-->
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr data-type="string" data-check='1' field="6" index="1">
                                        <td style="text-align: right;">操作：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
													<!--
                                                    <option value="equal">等于</option>
													-->
													<option title="包含" value="include">包含</option>
                                                    <option title="不包含" value="not include">不包含</option>
                                                    <option title="开始" value="begin">开始</option>
                                                    <option title="结束" value="end">结束</option>
													<option title="正则匹配" value="regx">正则匹配</option>
													<option title="正则不匹配" value="not regx">正则不匹配</option>
													<option title="正则匹配（忽略大小写）" value="ncregx">正则匹配（忽略大小写）</option>
													<option title="正则不匹配（区分大小写）" value="not ncregx">正则不匹配（区分大小写）</option>
													<option title="通配符" value="match">通配符</option>
													<!--
                                                    <option value="regx">正则表达式</option>
                                                    <option value="match">通配符</option>
													-->
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr data-type="string" data-check='1' field="6" index="2">
                                        <td style="text-align: right;">信息：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
													<!--
                                                    <option value="equal">等于</option>
													-->
													<option title="包含" value="include">包含</option>
                                                    <option title="不包含" value="not include">不包含</option>
                                                    <option title="开始" value="begin">开始</option>
                                                    <option title="结束" value="end">结束</option>
													<option title="正则匹配" value="regx">正则匹配</option>
													<option title="正则不匹配" value="not regx">正则不匹配</option>
													<option title="正则匹配（忽略大小写）" value="ncregx">正则匹配（忽略大小写）</option>
													<option title="正则不匹配（区分大小写）" value="not ncregx">正则不匹配（区分大小写）</option>
													<option title="通配符" value="match">通配符</option>
													<!--
                                                    <option value="regx">正则表达式</option>
                                                    <option value="match">通配符</option>
													-->
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr data-type="string" data-check='1' field="6" index="5">
                                        <td style="text-align: right;">客户端工具：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
													<!--
                                                    <option value="equal">等于</option>
													-->
													<option title="包含" value="include">包含</option>
                                                    <option title="不包含" value="not include">不包含</option>
                                                    <option title="开始" value="begin">开始</option>
                                                    <option title="结束" value="end">结束</option>
													<option title="正则匹配" value="regx">正则匹配</option>
													<option title="正则不匹配" value="not regx">正则不匹配</option>
													<option title="正则匹配（忽略大小写）" value="ncregx">正则匹配（忽略大小写）</option>
													<option title="正则不匹配（区分大小写）" value="not ncregx">正则不匹配（区分大小写）</option>
													<option title="通配符" value="match">通配符</option>
													<!--
                                                    <option value="regx">正则表达式</option>
                                                    <option value="match">通配符</option>
													-->
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont">
                                            </div>
                                        </td>
                                    </tr>
									
                                    <tr data-type="string" data-check='1' field="6" index="8">
                                        <td style="text-align: right;">数据库名：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
													<!--
                                                    <option value="equal">等于</option>
													-->
													<option title="包含" value="include">包含</option>
                                                    <option title="不包含" value="not include">不包含</option>
                                                    <option title="开始" value="begin">开始</option>
                                                    <option title="结束" value="end">结束</option>
													<option title="正则匹配" value="regx">正则匹配</option>
													<option title="正则不匹配" value="not regx">正则不匹配</option>
													<option title="正则匹配（忽略大小写）" value="ncregx">正则匹配（忽略大小写）</option>
													<option title="正则不匹配（区分大小写）" value="not ncregx">正则不匹配（区分大小写）</option>
													<option title="通配符" value="match">通配符</option>
													<!--
                                                    <option value="regx">正则表达式</option>
                                                    <option value="match">通配符</option>
													-->
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont">
                                            </div>
                                        </td>
                                    </tr>
									
                                    <tr data-type="string" data-check='1,2' field="6" index="20">
                                        <td style="text-align: right;">运维访问策略：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
													<!--
                                                    <option value="equal">等于</option>
													-->
													<option title="包含" value="include">包含</option>
                                                    <option title="不包含" value="not include">不包含</option>
                                                    <option title="开始" value="begin">开始</option>
                                                    <option title="结束" value="end">结束</option>
													<option title="正则匹配" value="regx">正则匹配</option>
													<option title="正则不匹配" value="not regx">正则不匹配</option>
													<option title="正则匹配（忽略大小写）" value="ncregx">正则匹配（忽略大小写）</option>
													<option title="正则不匹配（区分大小写）" value="not ncregx">正则不匹配（区分大小写）</option>
													<option title="通配符" value="match">通配符</option>
													<!--
                                                    <option value="regx">正则表达式</option>
                                                    <option value="match">通配符</option>
													-->
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr data-type="string" data-check='1,2' field="6" index="21">
                                        <td style="text-align: right;">运维操作备注：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
													<!--
                                                    <option value="equal">等于</option>
													-->
													<option title="包含" value="include">包含</option>
                                                    <option title="不包含" value="not include">不包含</option>
                                                    <option title="开始" value="begin">开始</option>
                                                    <option title="结束" value="end">结束</option>
													<option title="正则匹配" value="regx">正则匹配</option>
													<option title="正则不匹配" value="not regx">正则不匹配</option>
													<option title="正则匹配（忽略大小写）" value="ncregx">正则匹配（忽略大小写）</option>
													<option title="正则不匹配（区分大小写）" value="not ncregx">正则不匹配（区分大小写）</option>
													<option title="通配符" value="match">通配符</option>
													<!--
                                                    <option value="regx">正则表达式</option>
                                                    <option value="match">通配符</option>
													-->
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr data-type="string" data-check='1,2' field="6" index="22">
                                        <td style="text-align: right;">运维用户帐号：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
													<!--
                                                    <option value="equal">等于</option>
													-->
													<option title="包含" value="include">包含</option>
                                                    <option title="不包含" value="not include">不包含</option>
                                                    <option title="开始" value="begin">开始</option>
                                                    <option title="结束" value="end">结束</option>
													<option title="正则匹配" value="regx">正则匹配</option>
													<option title="正则不匹配" value="not regx">正则不匹配</option>
													<option title="正则匹配（忽略大小写）" value="ncregx">正则匹配（忽略大小写）</option>
													<option title="正则不匹配（区分大小写）" value="not ncregx">正则不匹配（区分大小写）</option>
													<option title="通配符" value="match">通配符</option>
													<!--
                                                    <option value="regx">正则表达式</option>
                                                    <option value="match">通配符</option>
													-->
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr data-type="string" data-check='1,2' field="6" index="23">
                                        <td style="text-align: right;">运维用户姓名：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
													<!--
                                                    <option value="equal">等于</option>
													-->
													<option title="包含" value="include">包含</option>
                                                    <option title="不包含" value="not include">不包含</option>
                                                    <option title="开始" value="begin">开始</option>
                                                    <option title="结束" value="end">结束</option>
													<option title="正则匹配" value="regx">正则匹配</option>
													<option title="正则不匹配" value="not regx">正则不匹配</option>
													<option title="正则匹配（忽略大小写）" value="ncregx">正则匹配（忽略大小写）</option>
													<option title="正则不匹配（区分大小写）" value="not ncregx">正则不匹配（区分大小写）</option>
													<option title="通配符" value="match">通配符</option>
													<!--
                                                    <option value="regx">正则表达式</option>
                                                    <option value="match">通配符</option>
													-->
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr data-type="string" data-check='1,2' field="6" index="24">
                                        <td style="text-align: right;">审批用户帐号：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
													<!--
                                                    <option value="equal">等于</option>
													-->
													<option title="包含" value="include">包含</option>
                                                    <option title="不包含" value="not include">不包含</option>
                                                    <option title="开始" value="begin">开始</option>
                                                    <option title="结束" value="end">结束</option>
													<option title="正则匹配" value="regx">正则匹配</option>
													<option title="正则不匹配" value="not regx">正则不匹配</option>
													<option title="正则匹配（忽略大小写）" value="ncregx">正则匹配（忽略大小写）</option>
													<option title="正则不匹配（区分大小写）" value="not ncregx">正则不匹配（区分大小写）</option>
													<option title="通配符" value="match">通配符</option>
													<!--
                                                    <option value="regx">正则表达式</option>
                                                    <option value="match">通配符</option>
													-->
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr data-type="string" data-check='1,2' field="6" index="25">
                                        <td style="text-align: right;">审批用户姓名：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
													<!--
                                                    <option value="equal">等于</option>
													-->
													<option title="包含" value="include">包含</option>
                                                    <option title="不包含" value="not include">不包含</option>
                                                    <option title="开始" value="begin">开始</option>
                                                    <option title="结束" value="end">结束</option>
													<option title="正则匹配" value="regx">正则匹配</option>
													<option title="正则不匹配" value="not regx">正则不匹配</option>
													<option title="正则匹配（忽略大小写）" value="ncregx">正则匹配（忽略大小写）</option>
													<option title="正则不匹配（区分大小写）" value="not ncregx">正则不匹配（区分大小写）</option>
													<option title="通配符" value="match">通配符</option>
													<!--
                                                    <option value="regx">正则表达式</option>
                                                    <option value="match">通配符</option>
													-->
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr data-type="string" data-check='2' field="6" index="26">
                                        <td style="text-align: right;">阻断用户帐号：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
													<!--
                                                    <option value="equal">等于</option>
													-->
													<option title="包含" value="include">包含</option>
                                                    <option title="不包含" value="not include">不包含</option>
                                                    <option title="开始" value="begin">开始</option>
                                                    <option title="结束" value="end">结束</option>
													<option title="正则匹配" value="regx">正则匹配</option>
													<option title="正则不匹配" value="not regx">正则不匹配</option>
													<option title="正则匹配（忽略大小写）" value="ncregx">正则匹配（忽略大小写）</option>
													<option title="正则不匹配（区分大小写）" value="not ncregx">正则不匹配（区分大小写）</option>
													<option title="通配符" value="match">通配符</option>
													<!--
                                                    <option value="regx">正则表达式</option>
                                                    <option value="match">通配符</option>
													-->
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr data-type="string" data-check='2' field="6" index="27">
                                        <td style="text-align: right;">阻断用户姓名：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
													<!--
                                                    <option value="equal">等于</option>
													-->
													<option title="包含" value="include">包含</option>
                                                    <option title="不包含" value="not include">不包含</option>
                                                    <option title="开始" value="begin">开始</option>
                                                    <option title="结束" value="end">结束</option>
													<option title="正则匹配" value="regx">正则匹配</option>
													<option title="正则不匹配" value="not regx">正则不匹配</option>
													<option title="正则匹配（忽略大小写）" value="ncregx">正则匹配（忽略大小写）</option>
													<option title="正则不匹配（区分大小写）" value="not ncregx">正则不匹配（区分大小写）</option>
													<option title="通配符" value="match">通配符</option>
													<!--
                                                    <option value="regx">正则表达式</option>
                                                    <option value="match">通配符</option>
													-->
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr data-type="string" data-check='1,2' field="6" index="28">
                                        <td style="text-align: right;">回放文件：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
													<!--
                                                    <option value="equal">等于</option>
													-->
													<option title="包含" value="include">包含</option>
                                                    <option title="不包含" value="not include">不包含</option>
                                                    <option title="开始" value="begin">开始</option>
                                                    <option title="结束" value="end">结束</option>
													<option title="正则匹配" value="regx">正则匹配</option>
													<option title="正则不匹配" value="not regx">正则不匹配</option>
													<option title="正则匹配（忽略大小写）" value="ncregx">正则匹配（忽略大小写）</option>
													<option title="正则不匹配（区分大小写）" value="not ncregx">正则不匹配（区分大小写）</option>
													<option title="通配符" value="match">通配符</option>
													<!--
                                                    <option value="regx">正则表达式</option>
                                                    <option value="match">通配符</option>
													-->
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr data-type="string" data-check='1' field="6" index="29">
                                        <td style="text-align: right;">策略名称：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
													<!--
                                                    <option value="equal">等于</option>
													-->
													<option title="包含" value="include">包含</option>
                                                    <option title="不包含" value="not include">不包含</option>
                                                    <option title="开始" value="begin">开始</option>
                                                    <option title="结束" value="end">结束</option>
													<option title="正则匹配" value="regx">正则匹配</option>
													<option title="正则不匹配" value="not regx">正则不匹配</option>
													<option title="正则匹配（忽略大小写）" value="ncregx">正则匹配（忽略大小写）</option>
													<option title="正则不匹配（区分大小写）" value="not ncregx">正则不匹配（区分大小写）</option>
													<option title="通配符" value="match">通配符</option>
													<!--
                                                    <option value="regx">正则表达式</option>
                                                    <option value="match">通配符</option>
													-->
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr data-type="string" data-check='1,2' field="6" index="30">
                                        <td style="text-align: right;">事件信息：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
													<!--
                                                    <option value="equal">等于</option>
													-->
													<option title="包含" value="include">包含</option>
                                                    <option title="不包含" value="not include">不包含</option>
                                                    <option title="开始" value="begin">开始</option>
                                                    <option title="结束" value="end">结束</option>
													<option title="正则匹配" value="regx">正则匹配</option>
													<option title="正则不匹配" value="not regx">正则不匹配</option>
													<option title="正则匹配（忽略大小写）" value="ncregx">正则匹配（忽略大小写）</option>
													<option title="正则不匹配（区分大小写）" value="not ncregx">正则不匹配（区分大小写）</option>
													<option title="通配符" value="match">通配符</option>
													<!--
                                                    <option value="regx">正则表达式</option>
                                                    <option value="match">通配符</option>
													-->
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr data-type="string" data-check='1,2' field="6" index="31">
                                        <td style="text-align: right;">告警对象：</td>
                                        <td>
                                            <select name="rzsxselectfirst" class="bb-select" onchange="_setField(this,0)">
                                                <option value="0">未指定</option>
                                                <option value="1">默认</option>
                                                <option value="2">可选</option>
                                            </select>
                                        </td>
                                        <td>
                                            <div class="secselect">
                                                <select name="rzsxselectsec" class="bb-select" onchange="_setField(this,1)">
													<!--
                                                    <option value="equal">等于</option>
													-->
													<option title="包含" value="include">包含</option>
                                                    <option title="不包含" value="not include">不包含</option>
                                                    <option title="开始" value="begin">开始</option>
                                                    <option title="结束" value="end">结束</option>
													<option title="正则匹配" value="regx">正则匹配</option>
													<option title="正则不匹配" value="not regx">正则不匹配</option>
													<option title="正则匹配（忽略大小写）" value="ncregx">正则匹配（忽略大小写）</option>
													<option title="正则不匹配（区分大小写）" value="not ncregx">正则不匹配（区分大小写）</option>
													<option title="通配符" value="match">通配符</option>
													<!--
                                                    <option value="regx">正则表达式</option>
                                                    <option value="match">通配符</option>
													-->
                                                </select>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="bb-sel-cont">
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <!---->
                <div id="Step3" style="display: none;">
                    <div class="bb-box">
                        <div class="bitem bitem-t bitem-t2">
                            <div class="btype">
                                <a href="javascript:;" class="active" onclick="_setType(this,1)"><i class="icon1"></i>统计型报表</a>
                                <a href="javascript:;" onclick="_setType(this,2)"><i class="icon2"></i>明细型报表</a>
                            </div>
                            <div class="br">
                                加载模块：
                                <select name="templateselect" id="templateselect" class="bb-select">
                                    <option value="默认">默认</option>
                                </select>
                                &nbsp;&nbsp;&nbsp;&nbsp;分页显示：
                                <input type="text" class="texin page_num" value="20" style="width: 2em"> 页
                            </div>
                        </div>
                        <div class="bitem bitem-tab" id="View1">
                            <table cellspacing="0" cellpadding="0" style="margin-bottom: 0" id="tabCont2">
                                <thead>
                                    <tr>
                                        <th width="90" style="text-align:right;">字段</th>
                                        <th width="110">组</th>
                                        <th>统计样式</th>
                                    </tr>
                                </thead>
                                <tbody id="trList2">
                                    <tr>
                                    </tr>
                                </tbody>
                            </table>
                            <table cellspacing="0" cellpadding="0" style="margin-bottom: 0;display: none;" id="tabCont3">
                                <thead>
                                    <tr>
                                        <th width="130" style="text-align:right;">优先级组</th>
                                        <th width="130">组内成员</th>
                                        <th>配置</th>
                                    </tr>
                                </thead>
                                <tbody id="trList3">
                                </tbody>
                            </table>
                            <table cellspacing="0" cellpadding="0" id="tabCont4" style="display: none;">
                                <thead>
                                    <tr>
                                        <th width="130" style="text-align:right;">扩展报表：</th>
                                        <th style="text-align:left;">
                                            <label class="cfix">
                                                <input type="checkbox" name="" id="QY4"><span class="check"></span>启用</label>
                                        </th>
                                    </tr>
                                </thead>
                            </table>
                        </div>
                        <div class="bitem bitem-tab" id="View2" style="display: none;">
                            <table cellspacing="0" cellpadding="0" style="margin-bottom: 0" id="tabCont2">
                                <thead>
                                    <tr>
                                        <th width="130" style="text-align:right;">字段</th>
                                        <th width="130">组</th>
                                        <th>统计样式</th>
                                    </tr>
                                </thead>
                                <tbody id="trList4">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <!---->
                <div id="Step4" style="display: none;">
                    <div class="bb-box">
                        <div class="bitem bitem-t bitem-t2">
                            <div class="btype">
                                <a href="javascript:;" class="active" onclick="_setType2(this,1)"><i class="icon1"></i>统计型报表</a>
                                <a href="javascript:;" onclick="_setType2(this,2)"><i class="icon2"></i>明细型报表</a>
                            </div>
                            <div class="br">
                                加载模块：
                                <select name="templateselect" id="templateselect" class="bb-select">
                                    <option value="默认">默认</option>
                                </select>
                                &nbsp;&nbsp;&nbsp;&nbsp;分页显示：
                                <input type="text" class="texin page_num" value="20" style="width: 2em"> 页
                            </div>
                        </div>
                        <div class="bitem bitem-tab" id="View21">
                            <table cellspacing="0" cellpadding="0" style="margin-bottom: 0" id="tabCont5">
                                <thead>
                                    <tr>
                                        <th width="90" style="text-align:right;">字段</th>
                                        <th width="110">组</th>
                                        <th>统计样式</th>
                                    </tr>
                                </thead>
                                <tbody id="trList5">
                                    <tr>
                                    </tr>
                                </tbody>
                            </table>
                            <table cellspacing="0" cellpadding="0" style="margin-bottom: 0;display: none;" id="tabCont6">
                                <thead>
                                    <tr>
                                        <th width="90" style="text-align:right;">优先级组</th>
                                        <th width="110">组内成员</th>
                                        <th>配置</th>
                                    </tr>
                                </thead>
                                <tbody id="trList6">
                                </tbody>
                            </table>
                        </div>
                        <div class="bitem bitem-tab" id="View22" style="display: none;">
                            <table cellspacing="0" cellpadding="0" style="margin-bottom: 0" id="tabCont2">
                                <thead>
                                    <tr>
                                        <th width="130" style="text-align:right;">字段</th>
                                        <th width="130">组</th>
                                        <th>统计样式</th>
                                    </tr>
                                </thead>
                                <tbody id="trList7">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
			
			<div id="bBtn" style="z-index: 5;">
				{% if temp_id == '0' and back_type == '0'%}
				<a href="javascript:;" class="btn" onclick="back();"><i class="icon-c3-1"></i>返&nbsp;&nbsp;&nbsp;&nbsp;回</a>
				{% else %}
				<a href="javascript:;" class="btn" onclick="back();"><i class="icon-c3-1"></i>取&nbsp;&nbsp;&nbsp;&nbsp;消</a>
				{% endif %}
			</div>
			
            <div class="btns bb-btns" style="/*text-align:center;*/">
				<!--
				{% if temp_id == '0' and back_type == '0'%}
					<a class="btn btn-fl btn-normal" href="javascript:;" onclick="back();">返&nbsp;&nbsp;回</a>
				{% else %}
					<a class="btn btn-fl btn-normal" href="javascript:;" onclick="back();">取&nbsp;&nbsp;消</a>
				{% endif %}
				-->
                <a class="btn btn-fr /*btn-primary-b*/ btn-prev btn-normal" href="javascript:;" onclick="_prevStep(this)" style="display: none;">上一步</a>
                <a class="btn btn-fr /*btn-primary-b*/ btn-next btn-normal" href="javascript:;" onclick="_nextStep(this)">下一步</a>
				<!--模板管理有管理权限-->
				{%if 12 in manage_power_id %}
                <a class="btn btn-fr /*btn-primary-b*/ btn-submit btn-normal" href="javascript:;" onclick="_submit(this)" style="display: none;">完成配置</a>
				{%endif%}
                
            </div>
        </div>
    </div>
    <!--temps-->
    <div id="forTemp" style="display: none;">
        <!--string-->
        <div class="bb-sel-item string-twin">
            <input type="text" class="texin">
            <span class="fix">-</span>
            <input type="text" class="texin">
            <span class="srsCtl">
                <a href="javascript:;" class="add" onclick="_itemAdd(this)"></a>
                <a href="javascript:;" class="del" onclick="_itemDel(this)"></a>
            </span>
        </div>
        <div class="bb-sel-item string-single">
            <input type="text" class="texin">
            <span class="srsCtl">
                <a href="javascript:;" class="add" onclick="_itemAdd(this)"></a>
                <a href="javascript:;" class="del" onclick="_itemDel(this)"></a>
            </span>
        </div>
        <!--time-->
        <div class="bb-sel-item time-twin srItem">
			<span class="stwrap">
				<input type="text" value="" placeholder="日期" class="datepicker" readonly>
				<input type="text" value="" placeholder="时" class="timeinput" min="00" max="23">
				<span class="srTip">:</span>
				<input type="text" value="" placeholder="分" class="timeinput" min="00" max="59">
				<span class="srTip">:</span>
				<input type="text" value="" placeholder="秒" class="timeinput" min="00" max="59">
			</span>
			<span class="srTip">至</span>
			<span class="stwrap">
				<input type="text" value="" placeholder="日期" class="datepicker" readonly>
				<input type="text" value="" placeholder="时" class="timeinput" min="00" max="23">
				<span class="srTip">:</span>
				<input type="text" value="" placeholder="分" class="timeinput" min="00" max="59">
				<span class="srTip">:</span>
				<input type="text" value="" placeholder="秒" class="timeinput" min="00" max="59">
			</span>
			<!--
            <input type="text" class="datepicker">
            <span class="fix">至</span>
            <input type="text" class="datepicker">
			-->
            <span class="srsCtl">
                <a href="javascript:;" class="add" onclick="_itemAdd(this)"></a>
                <a href="javascript:;" class="del" onclick="_itemDel(this)"></a>
            </span>
        </div>
        <div class="bb-sel-item time-single srItem">
			<span class="stwrap">
				<input type="text" value="" placeholder="日期" class="datepicker" readonly>
				<input type="text" value="" placeholder="时" class="timeinput" min="00" max="23">
				<span class="srTip">:</span>
				<input type="text" value="" placeholder="分" class="timeinput" min="00" max="59">
				<span class="srTip">:</span>
				<input type="text" value="" placeholder="秒" class="timeinput" min="00" max="59">
			</span>
			<!--
            <input type="text" class="datepicker">
			-->
            <span class="srsCtl">
                <a href="javascript:;" class="add" onclick="_itemAdd(this)"></a>
                <a href="javascript:;" class="del" onclick="_itemDel(this)"></a>
            </span>
        </div>
        <!--number-->
        <div class="bb-sel-item number-twin">
            <input type="text" class="texin">
            <span class="fix">-</span>
            <input type="text" class="texin">
            <span class="srsCtl">
                <a href="javascript:;" class="add" onclick="_itemAdd(this)"></a>
                <a href="javascript:;" class="del" onclick="_itemDel(this)"></a>
            </span>
        </div>
        <div class="bb-sel-item number-single">
            <input type="text" class="texin">
            <span class="srsCtl">
                <a href="javascript:;" class="add" onclick="_itemAdd(this)"></a>
                <a href="javascript:;" class="del" onclick="_itemDel(this)"></a>
            </span>
        </div>
        <!--ip-->
        <div class="bb-sel-item ip-twin">
            <input type="text" class="texin">
            <span class="fix">-</span>
            <input type="text" class="texin">
            <span class="srsCtl">
                <a href="javascript:;" class="add" onclick="_itemAdd(this)"></a>
                <a href="javascript:;" class="del" onclick="_itemDel(this)"></a>
            </span>
        </div>
        <div class="bb-sel-item ip-single bb-sel-item-sip">
			<select name="" onchange="_setDeAddr(this)" style="width: 8em">
                <option value="0">其他</option>
				<!--
                <option value="111">111</option>
                <option value="222">222</option>
				-->
            </select>
            <input type="text" class="texin">
            <span class="srsCtl">
                <a href="javascript:;" class="add" onclick="_itemAdd(this)"></a>
                <a href="javascript:;" class="del" onclick="_itemDel(this)"></a>
            </span>
        </div>
		<div class="bb-sel-item bb-sel-item-ingroup">
            <input type="text" class="texin forgroup" onclick="_getHostGroup(this)" readonly="">

            <span class="srsCtl">
                <a href="javascript:;" class="add" onclick="_itemAdd(this)"></a>
                <a href="javascript:;" class="del" onclick="_itemDel(this)"></a>
            </span>
        </div>
        <!--select-->
        <div class="bb-sel-item select-rzlx-single" style="margin-top:0px;">
            <select name="rzlxselect" class="" style="width:104px;">
                <option value="-1">选择类型</option>
				<!--
                <option value="2">*UNIX日志</option>
                <option value="3">WINDOWS事件</option>
                <option value="4">数据库访问</option>
                <option value="5">WEB服务</option>
                <option value="6">WEB访问</option>
                <option value="7">文件访问</option>
                <option value="8">远程控制</option>
                <option value="9">邮件收发</option>
                <option value="10">网络及安全设备</option>
                <option value="11">即时通讯</option>
                <option value="12">BBS访问</option>
                <option value="13">流量统计</option>
                <option value="14">AS400日志</option>
                <option value="15">数据库服务</option>
                <option value="16">FTP服务</option>
                <option value="17">运维会话日志</option>
                <option value="18">应用系统</option>
				-->
            </select>
            <span class="srsCtl">
                <a href="javascript:;" class="add" onclick="_itemAdd(this)"></a>
                <a href="javascript:;" class="del" onclick="_itemDel(this)"></a>
            </span>
        </div>
		<div class="bb-sel-item select-gjlx-single">
            <select name="rzlxselect" class="" style="width:104px;">
                <option value="0">无</option>
                <option value="1">违规操作</option>
                <option value="2">高危操作</option>
				<option value="3">登录异常</option>
            </select>
            <span class="srsCtl">
                <a href="javascript:;" class="add" onclick="_itemAdd(this)"></a>
                <a href="javascript:;" class="del" onclick="_itemDel(this)"></a>
            </span>
        </div>
        <div class="bb-sel-item select-gjdz-single">
            <select name="rzlxselect" class="" style="width:104px;">
                <option value="80">邮件</option>
				<option value="100">短信</option>
				<option value="2000">阻断</option>
				<option value="4000">SYSLOG</option>
				<option value="8000">SNMP</option>
				<option value="10000">忽略</option>
            </select>
            <span class="srsCtl">
                <a href="javascript:;" class="add" onclick="_itemAdd(this)"></a>
                <a href="javascript:;" class="del" onclick="_itemDel(this)"></a>
            </span>
        </div>
		<div class="bb-sel-item select-gjcl-single">
            <select name="rzlxselect" class="" style="width:104px;">
                <option value="0">未处理</option>
                <option value="1">已确认</option>
            </select>
            <span class="srsCtl">
                <a href="javascript:;" class="add" onclick="_itemAdd(this)"></a>
                <a href="javascript:;" class="del" onclick="_itemDel(this)"></a>
            </span>
        </div>
        <div class="bb-sel-item select-gjdj-single">
            <select name="rzlxselect" class="" style="width:104px;">
                <option value="0">无</option>
                <option value="1">高</option>
                <option value="2">中</option>
                <option value="3">低</option>
            </select>
            <span class="srsCtl">
                <a href="javascript:;" class="add" onclick="_itemAdd(this)"></a>
                <a href="javascript:;" class="del" onclick="_itemDel(this)"></a>
            </span>
        </div>
		<div class="bb-sel-item select-sfgj-single">
            <select name="rzlxselect" class="" style="width:104px;">
                <option value="0">无</option>
                <option value="1">告警</option>
            </select>
            <span class="srsCtl">
                <a href="javascript:;" class="add" onclick="_itemAdd(this)"></a>
                <a href="javascript:;" class="del" onclick="_itemDel(this)"></a>
            </span>
        </div>
    </div>
    <table id="forTemp2" style="display: none;">
        <tr>
            <td style="text-align: right;"></td>
            <td style="text-align: center;"></td>
            <td>
                <div class="ss">
                    <select onchange="change_order(this);" name="tongjizhipaixun" style="width: 120px">
                        <option value="64">统计值排序</option>
                        <option value="32">字段排序</option>
                        <option value="-1">---</option>
                    </select>
                    <select name="shengxujiangxu" style="width: 60px;">
                        <option value="0">升序</option>
                        <option value="1">降序</option>
                    </select>
                    <label class="cfix">
                        <input type="checkbox" name="showjishu"><span class="check"></span>显示计数值
                    </label>
                    <label class="cfix cf1" style="margin-left: 10px;display: none;">
                        <input type="checkbox" name="chaifen"><span class="check"></span>拆分
                    </label>
                    <label class="cfix cf2" style="margin-left: 10px;display: none;">
                        <input type="checkbox" name="hengxiangchaifen"><span class="check"></span>横向扩展
                    </label>
                </div>
                <div class="ss ss1">
                    <label class="cfix">
                        <input type="checkbox" name="xianshiguolv" onchange="_switchView(this);"><span class="check"></span>显示过滤</label>
                </div>
                <div class="ss ss2" style="display: none;">
                    <label class="cfix" style="margin-right: 10px;">
                        <input type="checkbox" name="qiancheck" onchange="_switchView2(this,0)"><span class="check"></span>前</label>
                    <input style="float: left;margin-right: 10px;width: 2em;" type="text" class="texin" name="qianinput" disabled>
                    <label class="cfix" style="margin-right: 10px;">
                        <input type="checkbox" name="houcheck" onchange="_switchView2(this,0)"><span class="check"></span>后</label>
                    <input style="float: left;margin-right: 10px;width: 2em;" type="text" class="texin" name="houinput" disabled>
                    <label class="cfix" style="margin-right: 10px;">
                        <input type="checkbox" name="zuidacheck" onchange="_switchView2(this,1)"><span class="check"></span>最大值</label>
                    <label class="cfix" style="margin-right: 10px;">
                        <input type="checkbox" name="zuixiaocheck" onchange="_switchView2(this,1)"><span class="check"></span>最小值</label>
                </div>
                <div class="ss ss1">
                    <label class="cfix">
                        <input type="checkbox" name="tongjiguolv" onchange="_switchView(this);"><span class="check"></span>统计过滤</label>
                </div>
				<div class="ss ss2" style="display: none;">
                    <span style="float: left;padding-right: 10px;">计数值：</span>
                    <select name="jishusel" style="width: 60px;" style="display: none;">
                        <option value="1">最大</option>
                    </select>
                    <select name="select" style="width: 60px;">
                        <option value="high">&gt;</option>
                        <option value="equal">=</option>
                        <option value="low">&lt;</option>
                    </select>
                    <input style="float: left;" type="text" class="texin" name="jishuinput">
                </div>
				<!--
                <div class="ss ss2" style="display: none;">
                    <span style="float: left;padding-right: 10px;">计数值：</span>
                    <select name="select" style="width: 60px;">
                        <option value="high">&gt;</option>
                        <option value="equal">=</option>
                        <option value="low">&lt;</option>
                    </select>
                    <input style="float: left;" type="text" class="texin" name="jishuinput">
                </div>
				-->
            </td>
        </tr>
    </table>
    <!---->
    <!--script-->
    <script src="/manage/js/jquery.min.js"></script>
    <script src="/manage/js/jquery.easing.js"></script>
    <script src="/manage/js/layer.js"></script>
    <script src="/manage/js/common.js"></script>
	<script src="/manage/js/common_e.js"></script>
    <!--select2-->
    <script src="/manage/js/select2.full.min.js"></script>
    <script>
    $('.bb-select').select2({ minimumResultsForSearch: -1 });
    </script>
    <!--icheck-->
    <script src="/manage/js/icheck.min.js"></script>
	<script src="/manage/js/base64.js"></script>
    <script>
    $('.bb-checkbox,.bb-radio').iCheck({
        checkboxClass: 'icheckbox_minimal-blue',
        radioClass: 'iradio_minimal-blue',
        increaseArea: '0' // optional
    });
    </script>
    <!--jedate-->
    <script src="/manage/js/jquery.jedate.min.js"></script>
    <link rel="stylesheet" href="/manage/css/jedate.css">
	<style>
	/*
	#back_Btn:hover i {
		transform: rotate(360deg);
	}
	#back_Btn:hover {
		width: 115px;
		margin-right: 0px;
		border-radius: 21px 0px 0px 21px;
	}
	#back_Btn {
		display: block;
		width: 42px;
		height: 42px;
		overflow: hidden;
		margin-right: 10px;
		background: #3FB7D2;
		border-radius: 21px;
		color: #fff;
		white-space: nowrap;
		line-height: 42px;
		font-size: 14px;
		transition: all 0.4s;
		text-decoration: none;
		font-style: normal;
		padding: 0;
	}
	#back_Btn i.icon2 {
		background-image: url(/manage/images/icon-cir2.png);
	}
	#back_Btn i {
		float: left;
		width: 42px;
		height: 42px;
		margin-right: 2px;
		background-repeat: no-repeat;
		background-position: 50% 50%;
		transition: all 0.4s;
	}
	*/
	.srItem .srTip{
		float: left;
		text-align: center;
		width: 24px;
		vertical-align: middle;
		padding: 0 5px 0 0;
	}
	.srItem input{
		height: 26px;
		background-color: #fff;
		border-radius: 5px;
	}
	.srItem {
		line-height: 28px;
		border-bottom:0;
	}
	table tr td:first-child{
		padding:10px;
	}
	</style>
    <script>
	var temp_id = "{{temp_id}}";
    var maxpage = 3;
	var se = "{{se}}";
	var click_first = 0;
	var first2 = 0;
	var first3 = 0;
	var first4 = 0;
	var classify_id;
	var edit_name;
	var back_type = "{{back_type}}";
	var alert_title;
    $(function() {
		if (temp_id == 0){
			clear_template();
			alert_title = "添加模板";
		}else{
			alert_title = "修改模板";
		}
		$(".page_num").bind('keydown', function(e){
			DigitInput(e);
        });
		        _initSize();
        _btnSwitch();
        _CheckType();
        _tampVal();
		
		$(".modify_icon").unbind().bind('click',function(){
			if (temp_id == '0'){
				parent._addModel();
			}else{
				parent.$(".bb-menu2").find('li.active').find('.edit').trigger('click');
			}
		});
		
        $('#QY4').on('change', function() {
            var v = $(this).prop('checked');
            if (v) {
                maxpage = 4;
                $('.tit-step li:eq(3)').show();
                $('.btn-next').show();
                $('.btn-submit').hide();
            } else {
                maxpage = 3;
                $('.tit-step li:eq(3)').hide();
                if(pagei == 3){
                    $('.btn-next').hide();
                    $('.btn-submit').show();
                }
            }
        });

        $('div.tit-step').on('click', 'li', function() {
            var i = $(this).index() + 1;
									if (i > pagei){
				if (click_first == 1){
					i = i - 1;
				}
				if (i - pagei == 2){
					var next_r = _nextStep();
					if (next_r == false){
						return false;
					}
					_nextStep();
				}else if (i - pagei == 3){
					var next_r = _nextStep();
					if (next_r == false){
						return false;
					}
					next_r = _nextStep();
					if (next_r == false){
						return false;
					}
					_nextStep();
				}else{
					pagei = i - 1;
					_nextStep();
				}
				if (click_first == 1){
					click_first = 0;
					_nextStep();
				}
			}else if (i < pagei){
				pagei = i + 1;
                _prevStep();
			}
			/*
            if (i > pagei) {
				if (click_first == 1){
					i = i - 1;
				}
                pagei = i - 1;
                _nextStep();
				if (click_first == 1){
					click_first = 0;
					_nextStep();
				}
            } else if (i < pagei) {
                pagei = i + 1;
                _prevStep();
            }
			*/
        });
		//获取分类
		var option_name = [];
		$.ajax({
			url:'/bhost/Get_DataReportTemplateType',
			type:'post',
			async:false,
			data:{a0:se,z1:"null"},
			success:function(result){
				var templatetype_array = JSON.parse(result);
				var option_str = "";
				$("#daleibox").empty();
				$.each(templatetype_array,function(i,item){
					option_name.push(item.Name);
					option_str = option_str + '<option value="'+item.TemplateTypeId+'">'+item.Name+'</option>';
				});
				$("#daleibox").append(option_str);
			}
		});
		//编辑
		if (temp_id != 0){
			$.ajax({
				url:'/bhost/Get_DataReportTemplate',
				type:'post',
				async:false,
				data:{a0:se,z2:temp_id},
				success:function(result){
					var result_data = JSON.parse(result);
					rpt_json = result_data[0].Condition;
									}
			});
			$("#RptName").val(rpt_json.RptName);
			edit_name = rpt_json.RptName;
			$("#daleibox").val(rpt_json.RpmemberId).trigger('change');
			classify_id = rpt_json.RpmemberId;
			//classify_id = $("#daleibox").children('option:eq('+option_name.indexOf(rpt_json.Rpmember)+')').val();
			//$("#daleibox").children('option:eq('+option_name.indexOf(rpt_json.Rpmember)+')').prop('selected',true).trigger('change');
			//$("#RptMemo").val(window.atob(rpt_json.RptMemo.substring(4)));
			//$("#RptSugg").val(window.atob(rpt_json.RptSugg.substring(4)));
			if (rpt_json.RptMemo != ""){
				$("#RptMemo").val(rpt_json.RptMemo);
			}
			if (rpt_json.RptSugg != ""){
				$("#RptSugg").val(rpt_json.RptSugg);
			}
			$("#DataFormat").val(rpt_json.RptFormat.DataFormat).trigger('change');
			$("#RptLoad").val(rpt_json.RptLoad).trigger('change');
			if (rpt_json.RptCont.indexOf('chart-') != -1){
				$("#graphic_report").next('div').find('span.bb-switch-btn').click();
			}
			if (rpt_json.RptCont.indexOf('layer-') != -1){
				$("#text_report").next('div').find('span.bb-switch-btn').click();
			}
			if (rpt_json.RptBuild.layer.length == 2){
				maxpage = 4;
				click_first = 1;
				$('.tit-step li:eq(3)').show();
			}
		}else{
			if (parent.$("div.bb-menu").find('li.active').length != 0){
				$("#daleibox").val(parent.$("div.bb-menu").find('li.active').attr('id').split('-')[1]).trigger('change');
			}
		}
    })
	
	$(document).on('keydown','input.timeinput',function(){
		var i = $(this).index();        
		var v = $(this).val();
		v = v.replace(/[^\d]/g,'');
		$(this).val(v);
	}).on('keyup','input.timeinput',function(e){
		var i = $(this).index();
		var v = $(this).val();    
		var max = 23;
		if(i>1){
			max = 59;
		}

		if(v > max){
			v = max;
		}

		$(this).val(v);

		v = v.toString();
		if(v.length >= 2){
			$(this).val(v.substring(0,2));

			var keycode = e.keyCode;
			if(keycode != 9){
				$(this).next().next().focus();
			}
		}
	}).on('focus','input.timeinput',function(){
		$(this).select();
	}).on('blur','input.timeinput',function(){
		var v = $(this).val();
		v = v.toString();

		if(v == ''){
			v = '00';
		}else if(v.length == 1){
			v = '0' + v;
		}

		$(this).val(v);
	});
	
	
    $(window).resize(function() {
        _initSize();
    })

    function _initSize() {
        var h = $(window).height();
        $('#bbCont').height(h - 123);
    }

    function _btnSwitch() {
        $('input.forSwitch').each(function() {
            var $this = $(this);
            var $c = $('<div class="bb-switch" />');
            var $b = $('<span class="bb-switch-btn" />');
            var $t = $('<span class="bb-switch-text" />');

            var text = $this.data('text').split('|');

            var check = $this.prop('checked');
            var disable = $this.prop('disabled');
			if (check) {
                $b.addClass('on');
                $t.text(text[0]);
            } else {
                $b.removeClass('on');
                $t.text(text[1]);
            }

            $c.append($b, $t);
            $this.hide().after($c);

            if (disable) {
                return;
            }

            $this.trigger('change');
            $b.on('click', function() {
                var check = $this.prop('checked');
				if (check) {
                    $this.prop('checked', false);
                    $b.removeClass('on');
                    $t.text(text[1]);
                } else {
                    $this.prop('checked', true);
                    $b.addClass('on');
                    $t.text(text[0]);
                }

                $this.trigger('change');
            })
        });
    }

    var pagei = 1;
	
    function _nextStep() {
		if (pagei == maxpage) {
			return;
		}

        if (pagei == 1) {
            var name = $('#RptName').val()//.trim();
            if (!name || name == '') {
				_alert(2,alert_title,"请输入报表名称",$('#RptName'));
                return false;
            }
			//var NameReg = /^[\u4e00-\u9fa5a-zA-Z\d_\-\.]+$/;
			var NameReg = /^[\u4e00-\u9fa5a-zA-Z\d]+$/;
			if (!NameReg.test(name)){
				_alert(1,alert_title,"报表名称格式不正确",$('#RptName'));
				return false;
			}
			var len = 0;
			for (var i = 0; i < name.length; i++) {
			   if (name.charAt(i).match(/[\u4E00-\u9FA5]/ig) != null){ //全角 
					len += 2; 
			   }else{
					len += 1;
				}			
			}
			if(len > 50){
				_alert(1,alert_title,"报表名称过长",$('#RptName'));
				return false;
			}
        }

        pagei++;
		if (pagei == 3){
			if ($("#log_attribute").find('input:checked').length == 0){
				pagei--;
				_alert(2,alert_title,"请选择日志属性");
				return false;
			}
			var check_r = check_step2();
						if (check_r == false){
				pagei--;
				return false;
			}
		}
		if (pagei == 4){
			var check3_r = check_step(3,$("#trList2"),$("#trList4"),$("#trList3"));
			if (check3_r == false){
				pagei--;
				return false;
			}
		}
		if (pagei == maxpage) {
			$('.btn-next').hide();
            $('.btn-submit').show();
        }
		if (temp_id != 0 && pagei == 2 && first2 == 0){
			var logtype_array = rpt_json.SearchDef.KeyLogType.split(',');
			$('.bb-checkbox').iCheck('uncheck');
			$.each(logtype_array,function(i,item){
				$("#CheckType"+item).iCheck('check');
			});
		}
        //page2
        if (pagei == 2 || pagei == 3) {
            var v1 = $('#CheckType1').prop('checked'),
                v2 = $('#CheckType2').prop('checked'),
                v3 = $('#CheckType3').prop('checked');
			
            if (v1 && !v2) {
                $('#trList>tr').each(function(i, item) {
                    var str = $(item).data('check').toString();
                    if (str.indexOf(1) >= 0) {
                        $(item).show().data('choose', 1);
                    }
                })
            } else if (!v1 && v2) {
                $('#trList>tr').each(function(i, item) {
                    var str = $(item).data('check').toString();
                    if (str.indexOf(2) >= 0) {
                        $(item).show().data('choose', 1);
                    }
                })
            } else if (v1 && v2) {
                $('#trList>tr').each(function(i, item) {
                    var str = $(item).data('check').toString();
                    if (str.indexOf(1) >= 0 && str.indexOf(2) >= 0) {
                        $(item).show().data('choose', 1);
                    }
                })
            } else if (v3) {
                $('#trList>tr').each(function(i, item) {
                    var str = $(item).data('check').toString();
                    if (str.indexOf(3) >= 0) {
                        $(item).show().data('choose', 1);
                    }
                })
            }
        }
								
		if (temp_id != 0 && pagei == 2 && first2 == 0){
			first2 = 1;
			//可选 selectop 2 默认 1 位指定 0
			//"value":["1","2"]
			//"value":[["3","4"],["5","6"]]
			//"value":["2017-10-11 00:00:00;2017-11-10 23:59:59"]
			//"value":["2017-10-11 00:00:00"]
			//"value":["1.1.1.1;2.2.2.2"]
			//"value":["1.11.1.1","2.2.2.2"]
			$.each(rpt_json.SearchDef.KeyRule.KeyCondition,function(i,item){
				//var $_tr = $("#trList").children('tr[field='+item.field+'][index='+item.index+']:visible');
				var $_tr = $("#trList").children('tr[field='+item.field+'][index='+item.index+']');
				var $_td1 = $_tr.children('td:eq(1)');
				var $_td2 = $_tr.children('td:eq(2)');
				var $_td3 = $_tr.children('td:eq(3)');
				
				$_td1.find('select').val(item.selectop).trigger('change');
				if (item.selectop == 1){
					$_td2.find('select').val(item.action).trigger('change');
					switch(item.action){
						case "ingroup":
							$.each(item.value,function(i1,item1){
								var $_c = $('#forTemp div.bb-sel-item-ingroup').clone();
								var hg_id = item1.split(':');
								$_c.find('input').attr('group',hg_id[0]);
								$_c.find('input').attr('title',hg_id[1]);
								$_c.find('input').val(hg_id[1]);
								$_td3.children('.bb-sel-cont').append($_c);
							});
							break;
						case "equal":
						case "high":
						case "ehigh":
						case "low":
						case "elow":
						case "not equal":
						case "begin":
						case "end":
						case "include":
						case "not include":
						case "regx":
						case "not regx":
						case "ncregx":
						case "not ncregx":
						case "match":
							if (item.type == 'ip'){						
								$.each(item.value,function(i1,item1){
									var $_c = $('#forTemp div.ip-single').clone();
									var host_str = "";
									$.ajax({
										url:'/bhost/get_host_rpt',
										type:'post',
										async:false,
										data:{a0:se},
										success:function(result){
											var host_result = JSON.parse(result);
											$.each(host_result,function(i,item){
												host_str = host_str + '<option value="'+item.HostIP+'-'+item.HostId+'">'+item.HostName+'</option>';
											});
										}
									});
									$_c.find('select').append(host_str);
									$_c.children('select').addClass('bb-select').select2();
									
									var ip_id = item1.split('-');
									if (ip_id.length == 1){
										if (i1 != item.value.length-1){
																						$_c.find('input:eq(0)').val(item1);
											$_td3.children('.bb-sel-cont').append($_c);
										}else{
											$_td3.children('.bb-sel-cont').find('input:eq(0)').val(item1);
										}
									}else{
										$_c.find('select:eq(0)').val(item1).trigger('change');
										if (i1 != item.value.length-1){
											$_td3.children('.bb-sel-cont').append($_c);
										}else{
											$_td3.children('.bb-sel-cont').find('select:eq(0)').val(item1).trigger('change');
										}
									}
								});
							}else if(item.type == 'select'){
								var select = $_tr.data('select');		
								$.each(item.value,function(i1,item1){
									var $_c = $('#forTemp div.select-' + select + '-single').clone();
									var sel_id = item1.split(':');
									if (i1 != item.value.length-1){
										if (select == "rzlx"){
										//if (type == "select-rzlx"){
											$.ajax({
												url:'/bhost/get_log_type',
												type:'post',
												async:false,
												data:{a0:se},
												success:function(result){
													var log_result = JSON.parse(result);
													var option_str = "";
													$.each(log_result.data,function(i,item){
														option_str = option_str + '<option value="'+item.ProtocolId+'">'+item.ProtocolName+'</option>';
													});
													$_c.children('select').append(option_str);
													$_c.children('select').addClass('bb-select').select2();
												}
											});
										}
										$_c.find('select:eq(0)').val(sel_id[0]).trigger('change');
										$_td3.children('.bb-sel-cont').append($_c);
										$_td3.children('.bb-sel-cont').find('select[name=rzlxselect]:last').select2({minimumResultsForSearch:-1});
										//$_td3.find('select:eq(0)').val().trigger('change');
									}else{
										//$_td3.children('.bb-sel-cont').append($_c);
										$_td3.find('select:eq(0)').val(sel_id[0]).trigger('change');
									}
								});
							}else if (item.type == 'time'){
								$.each(item.value,function(i1,item1){
									var ytd = item1.split(' ')[0];
									var hms = item1.split(' ')[1].split(':');
									var h = hms[0];
									var	m = hms[1];
									var s = hms[2];								
									var $_c = $('#forTemp div.time-single').clone();
									
									if (i1 != item.value.length-1){
										$_c.find('input:eq(0)').val(ytd);
										$_c.find('input:eq(1)').val(h);
										$_c.find('input:eq(2)').val(m);
										$_c.find('input:eq(3)').val(s);
										$_td3.children('.bb-sel-cont').append($_c);
									}else{
										$_td3.find('input:eq(0)').val(ytd);
										$_td3.find('input:eq(1)').val(h);
										$_td3.find('input:eq(2)').val(m);
										$_td3.find('input:eq(3)').val(s);
									}
								});
							}else{
								$.each(item.value,function(i1,item1){
									var $_c = $('#forTemp div.' + item.type + '-single').clone();
									$_c.find('input:eq(0)').val(item1);
									if (i1 != item.value.length-1){
										$_td3.children('.bb-sel-cont').append($_c);
									}else{
										$_td3.find('input:eq(0)').val(item1);
									}
								});
							}
							break;
						case "between":
						case "span":
						case "ehspan":
						case "elspan":
							$.each(item.value,function(i1,item1){
								var data_type = $_tr.data('type');
								if (data_type == "time"){
									var $_c = $('#forTemp div.time-twin').clone();
									var f_l_v = item1.split(';');
									var ytd_s = f_l_v[0].split(' ')[0];
									var hms_s = f_l_v[0].split(' ')[1].split(':');
									var ytd_e = f_l_v[1].split(' ')[0];
									var hms_e = f_l_v[1].split(' ')[1].split(':');
									if (i1 != item.value.length - 1){
										$_c.find('input:eq(0)').val(ytd_s);
										$_c.find('input:eq(1)').val(hms_s[0]);
										$_c.find('input:eq(2)').val(hms_s[1]);
										$_c.find('input:eq(3)').val(hms_s[2]);
										$_c.find('input:eq(4)').val(ytd_e);
										$_c.find('input:eq(5)').val(hms_e[0]);
										$_c.find('input:eq(6)').val(hms_e[1]);
										$_c.find('input:eq(7)').val(hms_e[2]);
										$_td3.children('.bb-sel-cont').append($_c);
									}else{
										$_td3.find('input:eq(0)').val(ytd_s);
										$_td3.find('input:eq(1)').val(hms_s[0]);
										$_td3.find('input:eq(2)').val(hms_s[1]);
										$_td3.find('input:eq(3)').val(hms_s[2]);
										$_td3.find('input:eq(4)').val(ytd_e);
										$_td3.find('input:eq(5)').val(hms_e[0]);
										$_td3.find('input:eq(6)').val(hms_e[1]);
										$_td3.find('input:eq(7)').val(hms_e[2]);
									}
								}else if (data_type == "ip"){
									var $_c = $('#forTemp div.ip-twin').clone();
									var f_l_v = item1.split(';');	
									if (i1 != item.value.length - 1){
										$_c.find('input:eq(0)').val(f_l_v[0]);
										$_c.find('input:eq(1)').val(f_l_v[1]);
										$_td3.children('.bb-sel-cont').append($_c);
									}else{
										$_td3.find('input:eq(0)').val(f_l_v[0]);
										$_td3.find('input:eq(1)').val(f_l_v[1]);
									}
								}else{
									var $_c = $('#forTemp div.' + data_type +'-twin').clone();	
									if (i1 != item.value.length - 1){
										$_c.find('input:eq(0)').val(item1[0]);
										$_c.find('input:eq(1)').val(item1[1]);
										$_td3.children('.bb-sel-cont').append($_c);
									}else{
										$_td3.find('input:eq(0)').val(item1[0]);
										$_td3.find('input:eq(1)').val(item1[1]);
									}
								}
							});
							break;
						default:
							//parent._errLayer('数据错误',"修改模板");
							_alert(1,"修改模板","数据错误");
							return false;
					}
										
				}
			});
		}
		
        //page3
        if (pagei >= 3) {
            _setContent();
			$("tr[data-type=number]").each(function (i, item) {
				$(item).find('input[type=text]').unbind().bind('keydown', function (e) {
					DigitInput(e);
				});
			});
			if (temp_id != 0){
				if (pagei == 3 && first3 == 0){
					first3 = 1;
					$.each(rpt_json.RptBuild.layer,function(i,item){
						if (item.level == 1){
							bind_table($("#trList2"),$("#trList4"),3,item,$("#trList3"));
						}
					});
				}else{//扩展报表
					if (first4 == 0){
						first4 = 1;
						$.each(rpt_json.RptBuild.layer,function(i,item){
							if (item.level == 2){
								bind_table($("#trList5"),$("#trList7"),4,item,$("#trList6"));
							}
						});
					}
				}
				
			}
        }
		$('#Step' + pagei).show().siblings().hide();
        $('div.tit-step li').eq(pagei - 1).addClass('active').show().siblings().removeClass('active');
		//if ($("#QY4").prop('checked'))
		if (rpt_json.RptBuild.layer.length == 2 && pagei != 3 && first3 == 0){
			$('.tit-step li:eq(3)').show();
		}
        $('.btn-prev').show();
    }
	
    function _prevStep() {
        if (pagei == 1) {
            return;
        }
        pagei--;
        if (pagei == 1) {
            $('.btn-prev').hide();
        }
        $('#Step' + pagei).show().siblings().hide();
        $('div.tit-step li').eq(pagei - 1).addClass('active').siblings().removeClass('active');
        $('.btn-next').show();
        $('.btn-submit').hide();
    }
	
	var checkkey_v = {
		"1":"最大",
		"2":"最小",
		"8":"平均",
		"16":"累积"
	}
	function bind_table(obj1,obj2,type,item,obj3){
		if (item.style == "detail"){
			$("#Step"+type).find('a:eq(1)').click();
		}else{
			$("#Step"+type).find('a:eq(0)').click();
		}
		$("#Step" + type).find('select:eq(0)').val(item.template);
		$("#Step" + type).find('input:eq(0)').val(item.page);
		
		if (item.style == "detail"){
			$.each(item.groupstat,function(i1,item1){
				var $_tr = $(obj2).children('tr[field='+item1.field+'][index='+item1.Index+']');
				var $_td1 = $_tr.children('td:eq(1)');
				var $_td2 = $_tr.children('td:eq(2)');
				if (item1.show == "true"){
					$_td1.find('input').iCheck('check').trigger('change');
					//$_td2.find('select').val(item1.GroupIndex).trigger('change');
				}
			});
			$.each(item.groupstat,function(i1,item1){
				var $_tr = $(obj2).children('tr[field='+item1.field+'][index='+item1.Index+']');
				var $_td2 = $_tr.children('td:eq(2)');
				if (item1.show == "true"){
					$_td2.find('select').val(item1.GroupIndex).trigger('change');
				}
			});
		}else{
						$.each(item.groupstat,function(i1,item1){
				var $_tr = $(obj1).children('tr[field='+item1.Field+'][index='+item1.Index+']');
				var $_td1 = $_tr.children('td:eq(1)');
				var $_td2 = $_tr.children('td:eq(2)');
				if (item1.Grouped == "true"){
					$_td1.find('input').iCheck('check').trigger('change');
				}
				if (item1.GroupUnit != ""){
					$_td1.find('select').val(item1.GroupUnit).trigger('change');
				}
				
				//$_td2.find('select:eq(0)').val(item1.GroupIndex).trigger('change');
				//$_td2.find('select:eq(1)').val(item1.GroupInnerIndex).trigger('change');
				if(item1.StatMethod != 0){
					var str_StatMethod = parseInt(item1.StatMethod,10).toString(2);
					var edit_StatMethod = str_StatMethod.toString().split("");
					edit_StatMethod =  edit_StatMethod.reverse();
					var num;
					$("#forTemp2").find('.ss.ss2').children('select:eq(0)').empty();
					for(z in edit_StatMethod){
						if(edit_StatMethod[z] == "1"){
							num = Math.pow(2,z).toString();
														if (num != '4'){
								$("#forTemp2").find('.ss.ss2').children('select:eq(0)').append('<option value="'+num+'">'+checkkey_v[num]+'</option>');
							}
							$_td2.find('input[value='+num+']').iCheck('check');
						}else{
							num = Math.pow(2,z).toString();
							$_td2.find('input[value='+num+']').iCheck('uncheck');
						}
					}
				}
				$_td2.find('select:eq(0)').val(item1.GroupIndex).trigger('change');
				$("#forTemp2").find('.ss.ss2').children('select:eq(0)').empty().append('<option value="1">最大</option>');
			});
			$.each(item.groupstat,function(i1,item1){
				var $_tr = $(obj1).children('tr[field='+item1.Field+'][index='+item1.Index+']');
				var $_td2 = $_tr.children('td:eq(2)');
				$_td2.find('select:eq(1)').val(item1.GroupInnerIndex).trigger('change');
			});
			$.each(item.config,function(i1,item1){
				//$_tr = $("#pzTr"+item1.GroupIndex);
				$_tr = $(obj3).find("#pzTr"+item1.GroupIndex);
				$_td2 = $_tr.children('td:eq(2)');
				$_td2.find('select:eq(0)').val(item1.Sort).trigger('change');
				if (item1.Sorttrue){
					$_td2.find('select:eq(1)').val(0).trigger('change');
				}else{
					$_td2.find('select:eq(1)').val(1).trigger('change');
				}
				if (item1.StatValueShow){
					$_td2.find('input:eq(0)').iCheck('check');
				}
				if (item1.Split){
										$_td2.find('input:eq(1)').iCheck('check');
				}
				if (item1.Lascande){
										$_td2.find('input:eq(2)').iCheck('check');
				}
				if (item1.Condition.opened){ //统计过滤
										$_td2.find('input:eq(10)').iCheck('check').trigger('change');
					$_td2.find('select:eq(2)').val(item1.Condition.ConditionType).trigger('change');
					$_td2.find('select:eq(3)').val(item1.Condition.action).trigger('change');
					$_td2.find('input:eq(11)').val(item1.Condition.value[0]);
				}
				if (item1.ShowFilter.opened){ //显示过滤
										$_td2.find('input:eq(3)').iCheck('check').trigger('change');
					if (item1.ShowFilter.top != 0){
												$_td2.find('input:eq(4)').iCheck('check').trigger('change');
						$_td2.find('input:eq(5)').val(item1.ShowFilter.top);
					}

					if (item1.ShowFilter.bottom){
												$_td2.find('input:eq(6)').iCheck('check').trigger('change');
						$_td2.find('input:eq(7)').val(item1.ShowFilter.bottom);
					}
					if (item1.ShowFilter.max){
												$_td2.find('input:eq(8)').iCheck('check');
					}
					if (item1.ShowFilter.min){
												$_td2.find('input:eq(9)').iCheck('check');
					}
				}
			});
			
			if (item.expand){
								//if ($("#View1").find('table:eq(2)').find('input').is(":visible")){
					$("#View1").find('table:eq(2)').find('input').iCheck('check').trigger('change');
				//}
			}
			
		}
	}
	
	//var IPReg = /^((?:(?:2[0-4][0-9]\.)|(?:25[0-5]\.)|(?:1[0-9][0-9]\.)|(?:[1-9][0-9]\.)|(?:[0-9]\.)){3}(?:(?:2[0-5][0-5])|(?:25[0-5])|(?:1[0-9][0-9])|(?:[1-9][0-9])|(?:[0-9])))$/;
	var IPReg = /(^(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\.(25[0-4]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])$)/;
    var numReg = /^[0-9]*$/;
	function test_input(obj){
		var td_t = $(obj).parents('td').siblings('td:eq(0)').text();
		var warn_cond = td_t.substring(0,td_t.length-1);
		var tr_type = $(obj).parents('tr').data('type');
		var td3_sel = $(obj).parents('tr').children('td:eq(2)').find('select').val();
						var inputReg;
		if (tr_type == "number"){
			inputReg = numReg;
		}else if (tr_type == "ip"){
			inputReg = IPReg;
		}else{
			inputReg = "";
		}
				var input_len = $(obj).parents('.bb-sel-item').find('input:visible').length;
										if (input_len == 0){
			var v = $(obj).parents('.bb-sel-item').find('select:visible').val();
			if (v == "-1"){ //select
				_alert(2, "报表条件", "请选择" + warn_cond);
				return false;
			}
		}else if (input_len == 1){ //非区间
			var v = $(obj).parents('.bb-sel-item').find('input:visible').val();
			if (v == ""){
				_alert(2, "报表条件", warn_cond + '不能为空',$(obj).parents('.bb-sel-item').find('input:visible'));
				return false;
			}
			if (inputReg != "" && !inputReg.test(v)){
				_alert(2, "报表条件", warn_cond + '格式不正确');
				return false;
			}
		}else if (input_len == 4){
			var ytd = $(obj).parents('.bb-sel-item').find('input:visible').eq(0).val();
			var h = $(obj).parents('.bb-sel-item').find('input:visible').eq(1).val();
			var m = $(obj).parents('.bb-sel-item').find('input:visible').eq(2).val();
			var s = $(obj).parents('.bb-sel-item').find('input:visible').eq(3).val();
			if (h > 23){
				_alert(2, "报表条件", warn_cond + '格式不正确',$(obj).parents('.bb-sel-item').find('input:visible').eq(1));
				return false;
			}
			if (m > 59){
				_alert(2, "报表条件", warn_cond + '格式不正确',$(obj).parents('.bb-sel-item').find('input:visible').eq(2));
				return false;
			}
			if (s > 59){
				_alert(2, "报表条件", warn_cond + '格式不正确',$(obj).parents('.bb-sel-item').find('input:visible').eq(3));
				return false;
			}
		}else if (input_len == 8){
			var ytd_s = $(obj).parents('.bb-sel-item').find('input:visible').eq(0).val();
			var h_s = $(obj).parents('.bb-sel-item').find('input:visible').eq(1).val();
			var m_s = $(obj).parents('.bb-sel-item').find('input:visible').eq(2).val();
			var s_s = $(obj).parents('.bb-sel-item').find('input:visible').eq(3).val();
			if (h_s > 23){
				_alert(2, "报表条件", warn_cond + '格式不正确',$(obj).parents('.bb-sel-item').find('input:visible').eq(1));
				return false;
			}
			if (m_s > 59){
				_alert(2, "报表条件", warn_cond + '格式不正确',$(obj).parents('.bb-sel-item').find('input:visible').eq(2));
				return false;
			}
			if (s_s > 59){
				_alert(2, "报表条件", warn_cond + '格式不正确',$(obj).parents('.bb-sel-item').find('input:visible').eq(3));
				return false;
			}
			var ytd_e = $(obj).parents('.bb-sel-item').find('input:visible').eq(4).val();
			var h_e = $(obj).parents('.bb-sel-item').find('input:visible').eq(5).val();
			var m_e = $(obj).parents('.bb-sel-item').find('input:visible').eq(6).val();
			var s_e = $(obj).parents('.bb-sel-item').find('input:visible').eq(7).val();
			if (h_e > 23){
				_alert(2, "报表条件", warn_cond + '格式不正确',$(obj).parents('.bb-sel-item').find('input:visible').eq(5));
				return false;
			}
			if (m_e > 59){
				_alert(2, "报表条件", warn_cond + '格式不正确',$(obj).parents('.bb-sel-item').find('input:visible').eq(6));
				return false;
			}
			if (s_e > 59){
				_alert(2, "报表条件", warn_cond + '格式不正确',$(obj).parents('.bb-sel-item').find('input:visible').eq(7));
				return false;
			}
			var time_r = _compare_time(ytd_s,ytd_e);
			if (time_r == 1){
				_alert(2, "报表条件", '结束' + warn_cond + "不能小于起始" + warn_cond);
				return false;
			}
			if (parseInt(h_e) < parseInt(h_s)){
				_alert(2, "报表条件", '结束' + warn_cond + "不能小于起始" + warn_cond, $(obj).parents('.bb-sel-item').find('input:visible').eq(5));
				return false;
			}
			if (parseInt(m_e) < parseInt(m_s)){
				_alert(2, "报表条件", '结束' + warn_cond + "不能小于起始" + warn_cond, $(obj).parents('.bb-sel-item').find('input:visible').eq(6));
				return false;
			}
			if (parseInt(s_e) < parseInt(s_s)){
				_alert(2, "报表条件", '结束' + warn_cond + "不能小于起始" + warn_cond, $(obj).parents('.bb-sel-item').find('input:visible').eq(7));
				return false;
			}
		}else{
			var f_v = $(obj).parents('.bb-sel-item').find('input:visible').eq(0).val();
			var l_v = $(obj).parents('.bb-sel-item').find('input:visible').eq(1).val();
			if (f_v == ""){
				_alert(2, "报表条件", warn_cond + '不能为空',$(obj).parents('.bb-sel-item').find('input:visible').eq(0));
				return false;
			}
			if (inputReg != "" && !inputReg.test(f_v)){
				_alert(2, "报表条件", warn_cond + '格式不正确',$(obj).parents('.bb-sel-item').find('input:visible').eq(0));
				return false;
			}
			
			if (l_v == ""){
				_alert(2, "报表条件", warn_cond + '不能为空',$(obj).parents('.bb-sel-item').find('input:visible').eq(1));
				return false;
			}
			if (inputReg != "" && !inputReg.test(l_v)){
				_alert(2, "报表条件", warn_cond + '格式不正确',$(obj).parents('.bb-sel-item').find('input:visible').eq(1));
				return false;
			}
			if (tr_type == "number"){
				if (parseInt(l_v) < parseInt(f_v)){
					_alert(2, "报表条件", '结束' + warn_cond + "不能小于起始" + warn_cond, $(obj).parents('.bb-sel-item').find('input:visible').eq(1));
					return false;
				}
			}else if (tr_type == "ip"){
				var ip_r = _compare_ip(f_v,l_v);
				if (ip_r == 1 || ip_r == 2){ //1相等 2大于 3小于
					_alert(2, "报表条件", '结束' + warn_cond + "不能小于起始" + warn_cond, $(obj).parents('.bb-sel-item').find('input:visible').eq(1));
					return false;
				}
			}/*else if (tr_type == "time"){
				var time_r = _compare_time(f_v,l_v);
				if (time_r == 1){
					if (temp_id == 0){
						_alert(2, "添加模板", '结束' + warn_cond + "不能小于起始" + warn_cond, $(obj).parents('.bb-sel-item').find('input:visible').eq(1));
						return false;
					}else{
						_alert(2, "修改模板", '结束' + warn_cond + '不能小于起始' + warn_cond, $(obj).parents('.bb-sel-item').find('input:visible').eq(1));
						return false;
					}
				}
			}*/
		}
		var isexist = 0;
		$.each($(obj).parents('.bb-sel-cont').children('.bb-sel-item').not($(obj).parents('.bb-sel-item')),function(i,item){
			if (tr_type == "ip" && (td3_sel == 'equal' || td3_sel == "not equal")){
				var sel_v = $(item).find('select:visible').val();
								var input_v = $(item).find('input').val();
																if (input_len == 0){
					n_v = v.split('-')[0];
				}else{
					n_v = v;
				}
				if (sel_v == 0){
					if (input_v == n_v){
						isexist = 1;
						_alert(2,"报表条件",warn_cond + '已存在',$(obj).parents('.bb-sel-item').find('input'));
						return false;
					}
				}else{
					if (sel_v.split('-')[0] == n_v){
						isexist = 1;
						_alert(2,"报表条件",warn_cond + '已存在');
						return false;
					}
				}
				return true;
			}
			if (input_len == 0){
				if (v == $(item).find('select:visible').val()){
					isexist = 1;
					_alert(2,"报表条件",warn_cond + '已存在');
					return false;
				}
			}else if (input_len == 1){
				if ($(item).find('input:visible').val() == v){
					isexist = 1;
					_alert(2,"报表条件",warn_cond + '已存在',$(obj).parents('.bb-sel-item').find('input:visible'));
					return false;
				}
			}else if (input_len == 2){
				var item_f_v = $(item).find('input:visible').eq(0).val();
				var item_l_v = $(item).find('input:visible').eq(1).val();
				if (f_v == item_f_v && l_v == item_l_v){
					isexist = 1;
					_alert(2,"报表条件",warn_cond + '区间已存在',$(obj).parents('.bb-sel-item').find('input:visible').eq(1));
					return false;
				}
			}else if (input_len == 4){
				var item_ytd = $(item).find('input:visible').eq(0).val();
				var item_h = $(item).find('input:visible').eq(1).val();
				var item_m = $(item).find('input:visible').eq(2).val();
				var item_s = $(item).find('input:visible').eq(3).val();
				if (item_ytd == ytd && item_h == h && item_m == m && item_s == s){
					isexist = 1;
					_alert(2,"报表条件",warn_cond + '已存在',$(obj).parents('.bb-sel-item').find('input:visible').eq(3));
					return false;
				}
			}else if (input_len == 8){
				var item_ytd_s = $(item).find('input:visible').eq(0).val();
				var item_h_s = $(item).find('input:visible').eq(1).val();
				var item_m_s = $(item).find('input:visible').eq(2).val();
				var item_s_s = $(item).find('input:visible').eq(3).val();
				var item_ytd_e = $(item).find('input:visible').eq(4).val();
				var item_h_e = $(item).find('input:visible').eq(5).val();
				var item_m_e = $(item).find('input:visible').eq(6).val();
				var item_s_e = $(item).find('input:visible').eq(7).val();
				
				if (item_ytd_s == ytd_s && item_h_s == h_s && item_m_s == m_s && item_s_s == s_s && item_ytd_e == ytd_e && item_h_e == h_e && item_m_e == m_e && item_s_e == s_e){
					isexist = 1;
					_alert(2,"报表条件",warn_cond + '区间已存在',$(obj).parents('.bb-sel-item').find('input:visible').eq(7));
					return false;
				}
			}
		});
		if (isexist == 1){
			return false;
		}
		return true;
	}
	
	function check_step2(){
		var test_r = true;
		$("#trList").children("tr[style*='display: table-row']").each(function(i,item){
			if ($(item).children('td:eq(1)').find('select:eq(0)').val() == 1){
				var $_add = $(item).children('td:eq(3)').find('a.add');
								$.each($_add,function(i2,item2){
					if (i2 == 0 && $_add.length != 1){
						
					}else{
						if ($(item).children('td:eq(2)').find('select').val() == "ingroup"){
							if ($(item2).parent().prev('input').val() == ""){
								_alert(2,alert_title,"请选择主机组");
								test_r = false;
								return false;
							}
						}else{
							test_r = test_input(item2);
							if (test_r == false){
								return false;
							}
						}
					}
				});
				if (test_r == false){
					return false;
				}
			}
		});
		if (test_r == false){
			return false;
		}else{
			return true;
		}
	}
	
	function check_step(type,obj1,obj2,obj3){
		var isexist = 0;
		var checked_num = 0;
		var rpt_type = $("#Step" + type).find('.btype').children('a.active').text();
				if (rpt_type == "统计型报表"){
			
			$(obj1).children('tr').each(function(i,item){
								if ($(item).children('td:eq(2)').find('select:eq(0)').val() == 0 && $(item).children('td:eq(1)').find('input').prop('checked')){
					isexist = 2;
					return false;
				}
				if ($(item).children('td:eq(2)').find('select:eq(0)').val() != 0){
					checked_num++;
				}
				
				/*
				if ($(item).children('td:eq(1)').find('input').prop('checked') && $(item).children('td:eq(2)').find('select:eq(0)').val() == 0){
					isexist = 2;
					return false;
				}
				*/
			});
			if(isexist == 2){
				_alert(2,alert_title,"请选择优先级组");
				return false;
			}
			if (checked_num == 0){
				_alert(2,alert_title,"至少设置一个优先级组");
				return false;
			}		
			/*
			if (isexist == 0){
				if (temp_id == 0){
					_alert(2,"添加模板","至少设置一个优先级组");
					return false;
				}else{
					_alert(2,"修改模板","至少设置一个优先级组");
					return false;
				}
			}
			*/
			
			isexist = 1;
			$(obj3).children('tr').each(function(i,item){
				var $_td2 = $(item).children('td:eq(2)');
				if ($_td2.children('.ss.ss1:eq(0)').find('input').prop('checked')){
					if ($_td2.children('.ss.ss2:eq(0)').find('input:eq(0)').prop('checked')){
						if ($_td2.children('.ss.ss2:eq(0)').find('input:eq(1)').val() == ""){
							_alert(2,alert_title,"请填写完整显示过滤",$_td2.children('.ss.ss2:eq(0)').find('input:eq(1)'));
							isexist = 0;
							return false;
						}else{
							isexist++;
						}	
					}
					if ($_td2.children('.ss.ss2:eq(0)').find('input:eq(2)').prop('checked')){
						if ($_td2.children('.ss.ss2:eq(0)').find('input:eq(3)').val() == ""){
							_alert(2,alert_title,"请填写完整显示过滤",$_td2.children('.ss.ss2:eq(0)').find('input:eq(3)'));
							isexist = 0;
							return false;
						}else{
							isexist++;
						}
					}
					if (isexist == 1){
						if (!$_td2.children('.ss.ss2:eq(0)').find('input:eq(4)').prop('checked') && !$_td2.children('.ss.ss2:eq(0)').find('input:eq(5)').prop('checked')){
							_alert(2,alert_title,"请填写完整显示过滤");
							isexist = 0;
							return false;
						}
					}
				}
				if ($_td2.children('.ss.ss1:eq(1)').find('input').prop('checked')){
					if ($_td2.children('.ss.ss2:eq(1)').find('input').val() == ""){
						_alert(2,alert_title,"请填写完整统计过滤",$_td2.children('.ss.ss2:eq(1)').find('input'));
						isexist = 0;
						return false;
					}
				}
			});
						if (isexist == 0){
				return false;
			}else{
				return true;
			}
		}else{
			$(obj2).children('tr').each(function(i,item){
				if ($(item).children('td:eq(1)').find('input').prop('checked')){
					isexist = 1;
					return false;
				}
			});
			if (isexist == 1){
				return true;
			}else{
				_alert(2,alert_title,"请至少设置一个显示位置");
				return false;
			}
		}
	}
	
    function _itemAdd(obj) {
        var $_c = $(obj).parents('div.bb-sel-item').clone();
        var test_r = test_input(obj);
				if (test_r == false){
						return false;
		}
		
		$(obj).parents('div.bb-sel-item').before($_c);
		$_c.find('input').val('');
		bind_date($_c);
		/*
        var now = new Date();
        var setDate = {
            year: now.getFullYear(),
            month: now.getMonth() + 1,
            day: now.getDate()
        }

        setDate = setDate.year + '-' + setDate.month + '-' + setDate.day;
        $_c.children('input.datepicker').each(function(i, item) {
            $(item).jeDate({
                format: "YYYY-MM-DD hh:mm:ss",
                isTime: true,
                maxDate: setDate + " 23:59:59"
            });

            if (i == 0) {
                $(item).val(setDate + " 00:00:00");
            } else {
                $(item).val(setDate + " 23:59:59");
            }
        })
		*/
        $('.select2', $_c).remove();
        //$('select', $_c).removeClass('select2-hidden-accessible').trigger('change').select2({ minimumResultsForSearch: -1 })
		$('select', $_c).removeClass('select2-hidden-accessible').trigger('change').select2();
    }

    function _itemDel(obj) {
        var $_obj = $(obj).parent().parent()
        $_obj.fadeOut(function() {
            $_obj.remove();
        })
    }

    function _setField(obj, i) {
        var v = $(obj).val();
		var type = $(obj).parents('tr').data('type');
        if (i == 0) {
            var $_sec = $(obj).parents('td').next('td');
            var $_thi = $_sec.next('td');
            if (v == 1) {
                $_sec.children('div.secselect').show().find('select').trigger('change');
            } else {
                $_sec.children('div.secselect').hide();
                $_thi.children('div.bb-sel-cont').empty();
            }
        } else if (i == 1) {
            var $_thi = $(obj).parents('td').next('td');
            //if(type == 'string'){
            if (type == 'select') {
                var select = $(obj).parents('tr').data('select');
                type += '-' + select;
            }
			if (type == "ip"){
				if (v == "between"){
					var $_c = $('#forTemp div.ip-twin').clone();
				}else if (v == "ingroup"){
					var $_c = $('#forTemp div.bb-sel-item-ingroup').clone();
				}else{
					var $_c = $('#forTemp div.ip-single').clone();
					var host_str = "";
					$.ajax({
						url:'/bhost/get_host_rpt',
						type:'post',
						async:false,
						data:{a0:se},
						success:function(result){
							var host_result = JSON.parse(result);
							$.each(host_result,function(i,item){
								host_str = host_str + '<option value="'+item.HostIP+'-'+item.HostId+'">'+item.HostName+'</option>';
							});
						}
					});
					$_c.find('select').append(host_str);
					$_c.children('select').addClass('bb-select').select2();
				}
			}else{
				if (v == 'between' || v == 'span' || v == 'ehspan' || v == 'elspan') {
					var $_c = $('#forTemp div.' + type + '-twin').clone();
				} else {
					var $_c = $('#forTemp div.' + type + '-single').clone();
					if (type == "select-rzlx"){
						$.ajax({
							url:'/bhost/get_log_type',
							type:'post',
							async:false,
							data:{a0:se},
							success:function(result){
								var log_result = JSON.parse(result);
								var option_str = "";
								$.each(log_result.data,function(i,item){
									option_str = option_str + '<option value="'+item.ProtocolId+'">'+item.ProtocolName+'</option>';
								});
								$_c.children('select').append(option_str);
								//$_c.children('select').select2();
								$_c.children('select').addClass('bb-select').select2();
							}
						});
					}else{
						$_c.children('select').addClass('bb-select').select2({ minimumResultsForSearch: -1 });
					}
				}
			}
            $_thi.children('div.bb-sel-cont').html($_c);
			bind_date($_thi);
			/*
            var now = new Date();
            var setDate = {
                year: now.getFullYear(),
                month: now.getMonth() + 1,
                day: now.getDate()
            }

            setDate = setDate.year + '-' + setDate.month + '-' + setDate.day;
            $_c.children('input.datepicker').each(function(i, item) {
                $(item).jeDate({
                    format: "YYYY-MM-DD hh:mm:ss",
                    isTime: true,
                    maxDate: setDate + " 23:59:59"
                });

                if (i == 0) {
                    $(item).val(setDate + " 00:00:00");
                } else {
                    $(item).val(setDate + " 23:59:59");
                }
            })
			*/
            //$_c.children('select').addClass('bb-select').select2({ minimumResultsForSearch: -1 });
			//$_c.children('select').addClass('bb-select').select2();
            //}
									        }
    }
	
	function bind_date(obj){
		var now = new Date();
		var setDate = now.getTime();
		setDate = new Date(setDate);
		
		var month = (setDate.getMonth() + 1).toString();
		var day =  setDate.getDate().toString();
		if(month.length == 1){
			month = '0' + month;
		}
		if(day.length == 1){
			day = '0' + day;
		}
		setDate = {
			year: setDate.getFullYear(),
			month: month,
			day: day
		}
		
		setDate = setDate.year + '-' + setDate.month + '-' + setDate.day;
		$('input.datepicker',$(obj)).each(function(){
			$(this).jeDate({
				format:"YYYY-MM-DD",
				isTime:true,
				//maxDate:setDate.year + "-" + setDate.month + "-" + setDate.day
			});
		});
		$('input.datepicker',$(obj)).each(function(i,item){
			if(i==0){
				$(item).val(setDate);
				$(item).parent().find('input.timeinput').val('00');
			}else if(i==1){
				$(item).val(setDate);
				$(item).parent().find('input.timeinput').each(function(i){
					if(i == 0){
						$(this).val('23');
					}else{
						$(this).val('59');
					}
				})
			}   
		});
									}
	
    //
    function _CheckType() {
        $('#trList>tr').data('choose', 0);
		
        var _changeType = function(){
						if (first3 != 0){
				$('#QY4').prop('checked',false).trigger('change');
				$('.tit-step li:eq(3)').hide();
			} 
			        }
		
        $('#CheckType1').on('ifChecked', function() {
            $('#CheckType3').prop('checked', false).iCheck('update');
            // $('#CheckType2').iCheck('update');
            if ($('#CheckType2').prop('checked')) {
                $('#trList>tr').each(function(i, item) {
                    var str = $(item).data('check').toString();
                    if (str.indexOf(1) >= 0 && str.indexOf(2) >= 0) {
                        $(item).show().data('choose', 1);
                    }else{
                        $(item).hide().data('choose', 0);
                    }
                })
            } else {
                $('#trList>tr').each(function(i, item) {
                    var str = $(item).data('check').toString();
                    if (str.indexOf(1) >= 0) {
                        $(item).show().data('choose', 1);
                    }else{
                        $(item).hide().data('choose', 0);
                    }
                })
            }

            _changeType();
        }).on('ifUnchecked', function() {
            var CheckType2=$('#CheckType2').prop('checked')
            $('#trList>tr').each(function(i, item) {
                var str = $(item).data('check').toString();
                if (str.indexOf(1) >= 0) {
                    $(item).hide().data('choose', 0);
                }
                if(CheckType2 && str.indexOf(2) >= 0){
                    $(item).show().data('choose', 1);
                }
            })
            /*
            if ($('#CheckType2').prop('checked')) {
                $('#trList>tr').each(function(i, item) {
                    var str = $(item).data('check').toString();
                    if (str.indexOf(2) >= 0) {
                        $(item).show().data('choose', 1);
                    }
                })
            }
            */
            _changeType();
        });

        $('#CheckType2').on('ifChecked', function() {
            $('#CheckType3').prop('checked', false).iCheck('update');
            // $('#CheckType1').iCheck('update');
            if ($('#CheckType1').prop('checked')) {
                $('#trList>tr').each(function(i, item) {
                    var str = $(item).data('check').toString();
                    if (str.indexOf(1) >= 0 && str.indexOf(2) >= 0) {
                        $(item).show().data('choose', 1);
                    }else{
                        $(item).hide().data('choose', 0);
                    }
                })
            } else {
                $('#trList>tr').each(function(i, item) {
                    var str = $(item).data('check').toString();
                    if (str.indexOf(2) >= 0) {
                        $(item).show().data('choose', 1);
                    }else{
                        $(item).hide().data('choose', 0);
                    }
                })
            }

            _changeType();
        }).on('ifUnchecked', function() {
            var CheckType1=$('#CheckType1').prop('checked');
            $('#trList>tr').each(function(i, item) {
                var str = $(item).data('check').toString();
                if (str.indexOf(2) >= 0) {
                    $(item).hide().data('choose', 0);
                }
                if(CheckType1 && str.indexOf(1) >= 0){
                    $(item).show().data('choose', 1);
                }
            })
            /*
            if ($('#CheckType1').prop('checked')) {
                $('#trList>tr').each(function(i, item) {
                    var str = $(item).data('check').toString();
                    if (str.indexOf(1) >= 0) {
                        $(item).show().data('choose', 1);
                    }
                })
            }
            */
            _changeType();
        });

        $('#CheckType3').on('ifChecked', function() {
            $('#CheckType1,#CheckType2').prop('checked', false).iCheck('update');
            $('#trList>tr').each(function(i, item) {
                var str = $(item).data('check').toString();
                if (str.indexOf(3) >= 0) {
                    $(item).show().data('choose', 1);
                } else {
                    $(item).hide().data('choose', 0);
                }
            })

            _changeType();
        }).on('ifUnchecked', function() {
            $('#trList>tr').each(function(i, item) {
                var str = $(item).data('check').toString();
                if (str.indexOf(3) >= 0) {
                    $(item).hide().data('choose', 0);
                }
            })

            _changeType();
        });
    }

    //
    function _setType(obj, i) {
        $(obj).addClass('active').siblings().removeClass('active');
        $('#View' + i).show().siblings('div.bitem-tab').hide();

        if (i == 2) {
            maxpage == 3;
            $('.tit-step li:eq(3)').hide();
            $('.btn-next').hide();
            $('.btn-submit').show();
        } else {
            var v = $('#QY4').prop('checked');
            if (v) {
                maxpage = 4;
                $('.tit-step li:eq(3)').show();
                $('.btn-next').show();
                $('.btn-submit').hide();
            } else {
                maxpage = 3;
                $('.tit-step li:eq(3)').hide();
                $('.btn-next').hide();
                $('.btn-submit').show();
            }
        }
    }

    function _setType2(obj, i) {
        $(obj).addClass('active').siblings().removeClass('active');
        $('#View2' + i).show().siblings('div.bitem-tab').hide();
    }

    var _contData = '',
        _oldContData = '';

    function _setContent() {
        var $_tr1 = $('#trList'),
            $_tr2 = $('#trList2'),
            $_tr4 = $('#trList4');

        var $_tr5 = $('#trList5'),
            $_tr7 = $('#trList7');

        _contData = '';
        var len = 0;
        $('>tr', $_tr1).each(function(i, item) {
            var _choose = $(item).data('choose');
            if (_choose == 1) {
                var name = $(item).children('td:first').text();
                _contData += name;
                len++;
            }
        });

        if (_oldContData != '' && _oldContData == _contData) {
            return;
        }

        _oldContData = _contData;
        $_tr2.empty();
        $_tr4.empty();
        $_tr5.empty();
        $_tr7.empty();

        $('>tr', $_tr1).each(function(i, item) {
            var _choose = $(item).data('choose');
            if (_choose == 0) {
                return;
            }
            var type = $(item).data('type'),
                name = $(item).children('td:first').text();
			var field = $(item).attr('field');
			var index = $(item).attr('index');
            var $_newtr = $('<tr field="'+field+'" index="'+index+'"/>');
            var $_td1 = $('<td style="text-align:right;">' + name + '</td>');
            var $_td2 = '';
            if (type == 'time') {
                $_td2 = $('<td><label class="cfix"><input type="checkbox" name="" id="" onchange="_switchCont(this);"><span class="check"></span>分组</label><select name="" id="" style="width:56px;display:none"><option value="day">天</option><option value="hour">小时</option><option value="minute">分钟</option></select></td>');
            } else {
                $_td2 = $('<td><label class="cfix"><input type="checkbox" name="" id="" onchange="_switchCont(this);"><span class="check"></span>分组</label></td>')
            }

            var $_td3 = $('<td class="temp3"><span style="float:left">优先级组：</span><select name="youxianji" id="youxianji" class="bb-select" style="width:54px;" onchange="_setTja(this)"></select><div class="tjWrap" style="float:left;display:none"><span style="float:left;padding-left:2em;">组内位置：</span><select name="weizhi" id="weizhi" class="bb-select" style="width:50px;" onchange="_setTjb(this)"><option value="0"></option></select></td>');

            $_td3.append('<div class="tjWrap2"><label class="cfix"><input type="checkbox" name="maxcheck" value="1" checked="checked" onclick="change_filter(this);"><span class="check" />最大</label><label class="cfix"><input type="checkbox" name="mincheck" value="2" onclick="change_filter(this);"><span class="check" />最小</label><label class="cfix"><input type="checkbox" name="luolie" value="4" onclick="change_filter(this);"><span class="check" />罗列</label><label class="cfix"><input type="checkbox" name="pincheck" value="8" onclick="change_filter(this);"><span class="check" />平均</label><label class="cfix"><input type="checkbox" name="leicheck" value="16" onclick="change_filter(this);"><span class="check" />累加</label></span></div>');
            $_newtr.append($_td1, $_td2, $_td3);
            $_tr2.append($_newtr);

            var $_newTr5 = $_newtr.clone();
            $_tr5.append($_newTr5);

			var $_newtr4 = $('<tr field="'+field+'" index="'+index+'"/>');
            var $_td5 = $('<td style="text-align:right;">' + name + '</td>');
            var $_td6 = $('<td><label class="cfix"><input type="checkbox" name="" id="" onchange="_switchCont2(this);"><span class="check"></span>显示</label></td>');
            var $_td7 = $('<td class="temp3"><div class="tjWrap" style="float:left;display:none"><span style="float:left;">位置：</span><select name="weizhi" id="weizhi" class="bb-select" style="width:60px;" onchange="_setTjc(this)"><option value="0"></option></select></td>');
            $_newtr4.append($_td5, $_td6, $_td7);
            $_tr4.append($_newtr4);
            var $_newtr7 = $_newtr4.clone();
            $_tr7.append($_newtr7);
        });

        var $_options = '<option value="0">---</option>';
        for (var i = 1; i <= len; i++) {
            $_options += '<option value="' + i + '">' + i + '</option>';
        }

        $('>tr', $_tr2).each(function(i, item) {
            $(item).children('td:eq(2)').children('select:first').html($_options).select2({ minimumResultsForSearch: -1, theme: 'default swsel' });;
        });

        $('>tr', $_tr5).each(function(i, item) {
            $(item).children('td:eq(2)').children('select:first').html($_options).select2({ minimumResultsForSearch: -1, theme: 'default swsel' });;
        });

        //
        $('#tabCont3,#tabCont6').hide().children('tbody').empty();
        $('#tabCont4').hide();
        $('#QY4').prop('checked', false).trigger('change')
    }
	//如果只有一个优先级组，不能显示拆分和横向拆分;否则优先级最高的显示拆分，最低的显示横向扩展
    function _switchCont(obj) {
        var $_tb = $(obj).parents('tbody');
        var v = $(obj).prop('checked');
        var $_sel = $(obj).parents('td').find('select'); //组下拉框
		var $_nextTb = $(obj).parents('table').next('table');
        var checkArr = new Array(),
            uncheckArr = new Array();
        $(obj).parents('tr').siblings().each(function(i, item) {
            //console.log($(item));
            var _tc = $(item).children('td:eq(1)').find('input').prop('checked'); //分组
            var _tv = $(item).children('td:eq(2)').find('select:first').val(); //优先级
            //console.log(_tc+'|'+_tv);
            if (_tv == 0) {
                return;
            }

            if (_tc) {
                checkArr.push(_tv);
            } else {
                uncheckArr.push(_tv);
            }
        })

        var sv = $(obj).parents('td').next('td').find('select:first').val(); //优先级组

        var max = Math.max.apply(null, checkArr),
            min = Math.min.apply(null, uncheckArr);
		_tempClickv = 0;
        if (v) {
            if (sv > min) {
                //parent._errLayer('分组优先级必须比未分组优先级高',"修改模板");
				_alert(1,"修改模板","分组优先级必须比未分组优先级高");
                $(obj).prop('checked', false);
                $('#pzTr' + sv).data('check', false);
                return;
            }
            if ($_sel) {
                $_sel.show().select2({ minimumResultsForSearch: -1, theme: 'default swsel' });
            }
            //$('#pzTr' + sv).data('check', true);
			$('#pzTr' + sv, $_nextTb).data('check', true);
            _switchView3($(obj).parents('table').next('table').children('tbody'));
            $(obj).parents('td').next().children('div.tjWrap2').hide();
            //$(obj).parents('td').next().find('select').trigger('change');
            var cv = $(obj).parents('td').next().find('select').val();
            var $_tab4 = $(obj).parents('table').next().next();
            if(cv != 0 && $_tab4){
                //$('#QY4').prop('checked',true);
                $_tab4.show();
                $_tab4.find('input').trigger('change');
            }
        } else {
            var $_sel2 = $(obj).parents('td').next('td').children('select:first'); //优先级组
            var _run = function() {
                if ($_sel) {
                    $_sel.select2().each(function() {
                        $(this).select2("destroy").hide();
                    });
                }

                var $_td = $(obj).parents('td').next('td'); //统计样式
                var v1 = $_td.find('select:first').val(); //优先级组
                $_td.find('select:first').each(function() {
                    $(this).select2("destroy").val(0).select2({ minimumResultsForSearch: -1, theme: 'default swsel' });
                });
                $_td.find('div.tjWrap').hide();

                var v2 = $_td.find('div.tjWrap').children('select').val();

                $('>tr', $_tb).each(function() {
                    var $_atd = $(this).children('td:eq(2)');
                    var av1 = $_atd.find('select:first').val();
                    var av2 = $_atd.find('select:eq(1)').val();

                    if (av1 == v1) {
                        if (av2 > v2) {
                            $_atd.find('select:eq(1)').val(av2 - 1).select2('destroy').select2({ minimumResultsForSearch: -1, theme: 'default swsel' });
                        }

                        $_atd.find('select:eq(1)').children('option:last').remove();
                        if ($_atd.find('select:eq(1)').data('select2')) {
                            $_atd.find('select:eq(1)').select2('destroy').select2({ minimumResultsForSearch: -1, theme: 'default swsel' });
                        }
                    }
                })
				var prv = false;
                //$('#pzTr' + sv).data('check', false);
				$('#pzTr' + sv, $_nextTb).data('check', prv);
                _switchView3($(obj).parents('table').next('table').children('tbody'));

                $_sel2.trigger('change');

            }

			var _run2 = function(){
                if ($_sel) {
                    $_sel.select2().each(function() {
                        $(this).select2("destroy").hide();
                    });
                }

                var $_td = $(obj).parents('td').next('td');
                var v1 = $_td.find('select:first').val();
                var v2 = $_td.find('div.tjWrap').children('select').val();

                $('>tr', $_tb).each(function() {
                    var $_atd = $(this).children('td:eq(2)');
                    var av1 = $_atd.find('select:first').val();
                    var av2 = $_atd.find('select:eq(1)').val();

                    if (av1 == v1) {
                        if (av2 > v2) {
                            $_atd.find('select:eq(1)').val(av2 - 1).select2('destroy').select2({ minimumResultsForSearch: -1, theme: 'default swsel' });
                        }

                        $_atd.find('select:eq(1)').children('option:last').remove();
                        if ($_atd.find('select:eq(1)').data('select2')) {
                            $_atd.find('select:eq(1)').select2('destroy').select2({ minimumResultsForSearch: -1, theme: 'default swsel' });
                        }
                    }
                })
            }

            var prv = false;
            var prvv = $_sel2.val();

            $('>tr', $_tb).each(function() {
                var $_atd = $(this).children('td:eq(2)');
                var av1 = $_atd.find('select:first').val();

                var _cd = $(this).children('td:eq(1)').find('input:checked').prop('checked');

                if(av1 == prvv && _cd){
                    prv = true;
                }

            })
			
            //$('#pzTr' + sv).data('check', false);
			$('#pzTr' + sv, $_nextTb).data('check', prv);
            if (sv == 0) {
                if ($_sel) {
                    $_sel.select2().each(function() {
                        $(this).select2("destroy").hide();
                    });
                }

                $_sel2.trigger('change');
                return;
            }

            if (sv < max && sv != 0) {
                //parent._errLayer('分组优先级必须比未分组优先级高',"修改模板");
				_alert(1,"修改模板","分组优先级必须比未分组优先级高");
                if ($.inArray(sv, checkArr) >= 0) {
                    _run();
                } else {
                    $(obj).prop('checked', true);
                    //$('#pzTr' + sv).data('check', true);
					$('#pzTr' + sv, $_nextTb).data('check', true);
                }

                $_sel2.trigger('change');
                return;
            }

            if ($_sel) {
                $_sel.select2().each(function() {
                    $(this).select2("destroy").hide();
                });
            }

            var cv = 0;

            $(obj).parents('tr').siblings().each(function(i,item){
                var vv = $(item).children('td:eq(1)').find('input').prop('checked');
                if(vv){
                    cv = 1;
                }
            });

            var $_tab4 = $(obj).parents('table').next().next();
            						            if(cv == 0 && $_tab4.length == 1){
				                maxpage = 3;
                $_tab4.show();
                $_tab4.find('input').prop('checked',false).trigger('change');
            }
			_run2();
            //$_sel2.val(0).select2('destroy').select2({ minimumResultsForSearch: -1,theme:'default swsel' });
            //$(obj).parents('td').children('div.tjWrap').hide();
            //$_sel2.next('.select2').trigger('click');
			            $_sel2.trigger('change');
			        }


    }

    function _switchCont2(obj) {
        var $_tb = $(obj).parents('tbody');
        var v = $(obj).prop('checked');

        var $_td = $(obj).parents('td').next('td');
        var $_sel = $_td.find('div.tjWrap').children('select');

        var len = $('input:checkbox:checked', $_tb).length;
        var $_options = '';
        for (var i = 1; i <= len; i++) {
            $_options += '<option value="' + i + '">' + i + '</option>';
        }

        if (v) {
            $_td.find('div.tjWrap').show();
            $_sel.empty().html($_options).val(len);
            if ($_sel.data('select2')) {
                $_sel.select2('destroy');
            }
            $_sel.select2({ minimumResultsForSearch: -1, theme: 'default swsel' });
            $(obj).parents('tr').siblings().each(function() {
                var $_atd = $(this).children('td:eq(2)');
                var c = $(this).children('td:eq(1)').find('input').prop('checked');

                if (c) {
                    var $_asel = $_atd.find('select:first');
                    var av1 = $_asel.val();
                    $_asel.html($_options).val(av1);
                    if ($_asel.data('select2')) {
                        $_asel.select2('destroy').select2({ minimumResultsForSearch: -1, theme: 'default swsel' });
                    }
                }
            });
        } else {
            $_td.find('div.tjWrap').hide();
            var v2 = $_sel.val();
            $('>tr', $_tb).each(function() {
                var $_atd = $(this).children('td:eq(2)');
                var av1 = $_atd.find('select:first').val();
                if (av1 > v2) {
                    $_atd.find('select').html($_options).val(av1 - 1);
                    if ($_atd.find('select').data('select2')) {
                        $_atd.find('select').select2('destroy').select2({ minimumResultsForSearch: -1, theme: 'default swsel' });
                    }
                } else {
                    $_atd.find('select').children('option:last').remove();
                    if ($_atd.find('select').data('select2')) {
                        $_atd.find('select').select2('destroy').select2({ minimumResultsForSearch: -1, theme: 'default swsel' });
                    }
                }

            });
        }

    }

    var tempVala, tempValb, tempValc, tempArra = new Array(),_tempClickv;

    function _tampVal() {
        $('#trList2,#trList5').on('click', '.select2', function() {
            var c = $(this).parent().attr('class');
            if (c == 'temp3') {
                tempVala = $(this).prev('select').val();
                /*
                tempArra = [];
                $('#trList2>tr').each(function(i,item){
                    var v = $(item).children('td:eq(2)').children('select').val();
                    if(v != 0){
                        tempArra.push(v);
                    }
                });
                */
				_tempClickv = 1;
            } else if (c == 'tjWrap') {
                tempValb = $(this).prev('select').val();
            }
        })

        $('#trList4,#trList7').on('click', '.select2', function() {
            tempValc = $(this).prev('select').val();
        })
    }

    function _setTja(obj) {
        var v = $(obj).val();
        var $_sel = $(obj).parents('td').find('div.tjWrap'); //组内位置div
        var $_tb = $(obj).parents('tbody'); //$("#trList2")
        tempValb = $_sel.children('select').val();//组内位置val
		
		var $_nextTb = $(obj).parents('table').next('table');
        var _check = $(obj).parents('td').prev('td').find('input:checkbox').prop('checked');//分组

        var checkArr = new Array(),
            uncheckArr = new Array();
        $(obj).parents('tr').siblings().each(function(i, item) {
            var _tc = $(item).children('td:eq(1)').find('input').prop('checked'); //分组
            var _tv = $(item).children('td:eq(2)').find('select:first').val(); //优先级组

            if (_tv == 0) {
                return;
            }

            if (_tc) {
                checkArr.push(_tv);
            } else {
                uncheckArr.push(_tv);
            }
        })

        var max = Math.max.apply(null, checkArr),//分组中最大的优先级组
            min = Math.min.apply(null, uncheckArr);//没分组中最小的优先级组
								        if (_check) {
            $(obj).parent().children('div.tjWrap2').hide(); //最大 最小 罗列
            if (v == 0) {
                $_sel.hide();
            } else {
				if (v > min){
					_alert(1,alert_title,"分组优先级必须比未分组优先级高");
					$(obj).val(0);
					if($(obj).data('select2')){
						var $_nsel = $(obj).next('.select2');
                        $('.select2-selection__rendered',$_nsel).text('---').attr('title',0);
					}
					return;
				}
                var alen = 0,
                    $_trObj = new Array(),
                    _trVal = new Array();
                $('>tr', $_tb).each(function(i, item) {
                    var check = $(item).children('td:eq(1)').find('input').prop('checked'); //分组
                    var $_fsel = $(item).children('td:eq(2)').find('select:first'); //优先级组
                    var $_ssel = $(item).children('td:eq(2)').find('select:eq(1)'); //组内位置
                    if ($_fsel.val() == v && check) {
                        alen++;
                        if ($_ssel) {
                            $_trObj.push($_ssel);
                            _trVal.push($_ssel.val());
                        }
                    }
                });

                var $_options = '';
                for (var i = 1; i <= alen; i++) {
                    $_options += '<option value="' + i + '">' + i + '</option>';
                }

                $.each($_trObj, function(i2, item2) {
                    $(item2).html($_options).val(_trVal[i2]).select2({ minimumResultsForSearch: -1, theme: 'default swsel' });;
                });

                $_sel.children('select').html($_options).val(alen).select2({ minimumResultsForSearch: -1, theme: 'default swsel' });

                $('>tr', $_tb).each(function() {
                    var $_atd = $(this).children('td:eq(2)'); //统计样式
                    var av1 = $_atd.find('select:first').val(); //优先级组
                    var av2 = $_atd.find('select:eq(1)').val(); //组内位置

                    if (av1 == tempVala) {
                        if (av2 > tempValb) {
                            $_atd.find('select:eq(1)').val(av2 - 1).select2('destroy').select2({ minimumResultsForSearch: -1, theme: 'default swsel' });
                        }

                        $_atd.find('select:eq(1)').children('option:last').remove();
                        if ($_atd.find('select:eq(1)').data('select2')) {
                            $_atd.find('select:eq(1)').select2('destroy').select2({ minimumResultsForSearch: -1, theme: 'default swsel' });
                        }
                    }
                });

                $('>tr', $_tb).each(function(i, item) {
                    var check = $(item).children('td:eq(1)').find('input').prop('checked');
                    var v2 = $(item).children('td:eq(2)').children('select').val();

                    if (!check && v2 == v) {
                        $(item).children('td:eq(1)').find('input').prop('checked', true).iCheck('update');
                        $(item).children('td:eq(2)').children('select').trigger('change');
                    }
                })
            }
        } else {
            if (v < max && v != 0) {
				_alert(1,alert_title,"分组优先级必须比未分组优先级高");
                //$(obj).val(tempVala).select2('destroy').select2({ minimumResultsForSearch: -1, theme: 'default swsel' });
                $(obj).val(tempVala);
                var tempText = tempVala;
                if(tempVala == 0){
                    tempText = '---';
                }
                if($(obj).data('select2')){
                    var $_nsel = $(obj).next('.select2');
                    $('.select2-selection__rendered',$_nsel).text(tempText).attr('title',tempVala);
                }
                return;
            }
            var tempArra = new Array();
            $(obj).parents('tr').siblings().each(function(i, item) {
                var v = $(item).children('td:eq(2)').children('select').val();
                if (v != 0) {
                    tempArra.push(v);
                }
            });
			if ($.inArray(v, tempArra) >= 0) {
				if(_tempClickv == 1){
					_alert(1,alert_title,"未分组字段不能选择同一分组优先级");
                }
                //$(obj).val(0).select2('destroy').select2({ minimumResultsForSearch: -1, theme: 'default swsel' });
                $(obj).val(0);
                if($(obj).data('select2')){
                    var $_nsel = $(obj).next('.select2');
                    $('.select2-selection__rendered',$_nsel).text('---').attr('title',0);
                }
                $(obj).parents('td').children('div.tjWrap').hide();
				$(obj).parents('td').children('div.tjWrap2').hide();
                _viEvent($_tb);
                return;
            }

            if (v == 0) {
                $(obj).parent().children('div.tjWrap2').hide();
            } else {
                $(obj).parent().children('div.tjWrap2').show();
            }

        }

        if (v == 0) {
            $(obj).parents('td').children('div.tjWrap').hide();
            //$('#pzTr' + tempVala).remove();
			$('#pzTr' + tempVala, $_nextTb).remove();
        } else {
            //if(!_check){
            $(obj).parents('td').children('div.tjWrap').show();
            var $_tsel = $(obj).parents('td').children('div.tjWrap').find('select');

            if ($_tsel.data('select2')) {
                //$_tsel.val(tempVala).select2('destroy');
            }

            if (!_check) {
                $_tsel.html('<option value="1">1</option>');
            }

            $_tsel.select2({ minimumResultsForSearch: -1, theme: 'default swsel' });
            //}
        }

        _viEvent($_tb); //获取trList3
        _switchView3($(obj).parents('table').next('table').children('tbody'));
    }

    function _setTjb(obj) {
        var v = $(obj).val();
        var _va = $(obj).parents('td').find('select:first').val();
        var $_tb = $(obj).parents('tbody');

        $(obj).parents('tr').siblings('tr').each(function(i, item) {
            var _vb = $(item).children('td:eq(2)').find('select:first').val();
            var _vc = $(item).children('td:eq(2)').find('select:eq(1)').val();

            if (_va == _vb && v == _vc) {
                $(item).children('td:eq(2)').find('select:eq(1)').val(tempValb).select2('destroy').select2({ minimumResultsForSearch: -1, theme: 'default swsel' });
            }
        });
    }

    function _setTjc(obj) {
        var v = $(obj).val();
        var $_tb = $(obj).parents('tbody');

        $(obj).parents('tr').siblings('tr').each(function(i, item) {
            var _vb = $(item).children('td:eq(2)').find('select:first').val();

            if (v == _vb) {
                $(item).children('td:eq(2)').find('select:first').val(tempValc).select2('destroy').select2({ minimumResultsForSearch: -1, theme: 'default swsel' });
            }
        });
    }
	
	function search_i(id, data) {
		var mid, res;
		var min = 0;
		var max = data.length-1;
		if (parseInt(data[max]) < parseInt(id)) {
			return -1;
		}
		if (parseInt(data[min]) > parseInt(id)) {
			return -2;
		}
		while (min <= max) {
			mid = parseInt((min + max) / 2);
			if (parseInt(data[mid]) > parseInt(id)) {
				max = mid - 1;
				res = mid;
			} else {
				min = mid + 1;
			}
		}
		return res;
	}
	
    function _viEvent(obj) {

        var $_tb = $(obj); //$("#trList2")
        var $_nextTb = $_tb.parent().next('table').children('tbody'); //trList3
        $('tr>td:eq(1)', $_nextTb).empty();
        $('>tr', $_tb).each(function(i, item) {
            var check = $(item).children('td:eq(1)').find('input:checkbox').prop('checked');//分组
            var v = $(item).children('td:eq(2)').children('select:eq(0)').val();//优先级组
            var name = $(item).children('td:eq(0)').text().replace('：', '');

            if (v && v != 0) {
                var $_pz = $('#pzTr' + v, $_nextTb);
                if ($_pz.length == 0) {
                    $_pz = $('#forTemp2').find('tr:first').clone().attr('id', 'pzTr' + v).data('check', check);
                    $_nextTb.append($_pz);
                    $_pz.children('td:eq(0)').text('优先级组' + v + '：');
                }
                var nameArr = new Array();
                $_pz.children('td:eq(1)').children('div').each(function() {
                    nameArr.push($(this).text());
                });

                if ($.inArray(name, nameArr) < 0) {
                    $_pz.children('td:eq(1)').append('<div>' + name + '</div>');
                }

                $_pz.find('select').each(function() {
                    var d = $(this).data('select2');
                    if (!d) {
                        $(this).select2({ minimumResultsForSearch: -1, theme: 'default swsel' });
                    }
                })

                $_pz.siblings('tr').each(function(i2, item2) {
                    $(item2).children('td:eq(1)').children('div').each(function() {
                        if ($(this).text() == name) {
                            $(this).remove();
                        };

                        if ($(item2).children('td:eq(1)').children('div').length == 0) {
                            $(item2).remove();
                        }
                    });
                })

                if (check) {
                    $_pz.children('td:eq(2)').children('div.ss:eq(1)').show();
                } else {
                    $_pz.children('td:eq(2)').children('div.ss:eq(1)').hide();
                }
            }
        });

        $('>tr', $_nextTb).each(function(i2, item2) {
            if ($(item2).children('td:eq(1)').children('div').length == 0) {
                $(item2).remove();
            }
        })

        if ($('>tr', $_nextTb).length > 0) {
            $_nextTb.parent().show();
        } else {
            $_nextTb.parent().hide();
        }

		if ($_tb.attr('id') != "trList5"){
			var mlen = 0;
			$('>tr', $_tb).each(function() {
				if ($(this).children('td:eq(1)').find('input').prop('checked') && $(this).children('td:eq(2)').find('select:first').val() != 0) {
					mlen++;
				}
			});
						if (mlen > 0) {
				$('#tabCont4').show();
			} else {
				$("#QY4").prop('checked',false).trigger('change');
				$('#tabCont4').hide();
			}
		}
        _switchView3($_nextTb);
    }

    function _switchView3(obj) {
        var $_nextTb = $(obj); //$("#trList3")
		//sort
		var arr = new Array();
        $('>tr',$_nextTb).each(function(){
            var i = $(this).attr('id').replace('pzTr','');
            arr.push([i,this]);
        });
		var sortNumber = function (a,b){
            return a[0] - b[0];
        }
        arr.sort(sortNumber);

        $.each(arr,function(){
            $(this[1]).appendTo($_nextTb);
        })
		
		
        $('>tr', $_nextTb).find('.ss:first').children('label.cf1').hide(); //拆分
		$('>tr', $_nextTb).find('.ss:first').children('label.cf1').children('input').prop('checked',false);
        $('>tr', $_nextTb).find('.ss:first').children('label.cf2').hide(); //横向扩展
		$('>tr', $_nextTb).find('.ss:first').children('label.cf2').children('input').prop('checked',false);
        if ($('>tr', $_nextTb).length > 1) {
            var nc1 = $('>tr:first', $_nextTb).data('check');

            if (nc1) {
                $('>tr:first', $_nextTb).find('.ss:first').children('label.cf1').show();
            } else {
                $('>tr:first', $_nextTb).find('.ss:first').children('label.cf1').hide();
				$('>tr:first', $_nextTb).find('.ss:first').children('label.cf1').children('input').prop('checked',false);
            }

            var nc2 = $('>tr:last', $_nextTb).data('check');
            if (nc2) {
                $('>tr:last', $_nextTb).find('.ss:first').children('label.cf2').show();
            } else {
                $('>tr:last', $_nextTb).find('.ss:first').children('label.cf2').hide();
				$('>tr:last', $_nextTb).find('.ss:first').children('label.cf2').children('input').prop('checked',false);
            }
        } else {
            $('>tr:first', $_nextTb).find('.ss:first').children('label.cf1').hide();
            $('>tr:last', $_nextTb).find('.ss:first').children('label.cf2').hide();
			$('>tr:first', $_nextTb).find('.ss:first').children('label.cf1').children('input').prop('checked',false);
			$('>tr:last', $_nextTb).find('.ss:first').children('label.cf2').children('input').prop('checked',false);
        }
		/*
        $('>tr', $_nextTb).each(function(i, item) {
            var _check = $(item).data('check');
            if (_check) {
                $(item).find('div.ss:eq(1)').show();
            } else {
                $(item).find('div.ss:eq(1),div.ss:eq(2)').hide();
                $(item).find('div.ss:eq(1)').find('input').prop('checked', false);
            }
        });
		*/
		$('>tr', $_nextTb).each(function(i, item) {
            var _check = $(item).data('check');
						            if (_check) {
                $(item).find('div.ss:eq(1)').show();
                $(item).find('div.ss:eq(4)').children('span:first').show();
                $(item).find('div.ss:eq(4)').children('.select2:first').hide();
            } else {
                $(item).find('div.ss:eq(1),div.ss:eq(2)').hide();
                $(item).find('div.ss:eq(1)').find('input').prop('checked', false);
                $(item).find('div.ss:eq(4)').children('span:first').hide();
                $(item).find('div.ss:eq(4)').children('.select2:first').show();
            }
        })
    }

    function _switchView(obj) {
        var v = $(obj).prop('checked');
        var $c = $(obj).parents('div.ss').next('div.ss');

        if (v) {
            $c.show();
        } else {
            $c.hide();
        }
    }
	
    function _switchView2(obj, i) {
        var v = $(obj).prop("checked");
        var $_ins = $(obj).parents('div.ss').find('input:checkbox');

        if (v) {
            if (i == 0) {
                $_ins.eq(2).prop('checked', false);
                $_ins.eq(3).prop('checked', false);

                $(obj).parent().next('input').prop('disabled', false);
            } else if (i == 1) {
                $_ins.eq(0).prop('checked', false).parent().next('input').prop('disabled', true).val('');
                $_ins.eq(1).prop('checked', false).parent().next('input').prop('disabled', true).val('');
            }
        } else {
            $(obj).parent().next('input').prop('disabled', true).val('');
        }
    }

    //
	
	var temp_json = {
        "Id": 1,
        "Name": "BBS访问主题信息统计报告",
        "UserCode": "yt",
        "Condition": "abc",
        "TemplateTypeId": 1
	}
	var rpt_json = {
		"RptName":"",
		"RptMemo":"",
		"RptSugg":"",
		"Rpmember":"",
		"RpmemberId":1,
		"RptUser":"",
		"RptTime":"",
		"RptLoad":"",
		"RptFormat":{
			"DataFormat":"CSV",
			"Staticed":true,
			"StaticPeriod":""
		},
		"RptMail":{
			"MailOpend":true,
			"MailAddress":""
		},
		"RptCont":"catalog|abstract|chart-|layer-",
		"RptCond":[],
		"SearchDef":{
			"KeyLogType":5,
			"KeyRule":{
				"KeyCondition":[],
			}
		},
		"RptBuild":{
			"abstract":"",
			"layer":[]
		}
	}
    //提交
	function _submit() {
		var usercode = window.parent.parent.document.frm.us.value;
		rpt_json.RptBuild.layer = [];
		rpt_json.RptUser = usercode;
		var RptName = $("#RptName").val().trim();
		rpt_json.RptName = RptName;
		
		var Rpmember_id = $("#daleibox").val();
		rpt_json.RpmemberId = Rpmember_id;
		rpt_json.Rpmember = $("#daleibox").children('option[value='+Rpmember_id+']').text();
		
		var RptMemo = $("#RptMemo").val(); //需要base64加密
		if (RptMemo != ""){
			var len = 0;
			for (var i = 0; i < RptMemo.length; i++) {
			   if (RptMemo.charAt(i).match(/[\u4E00-\u9FA5]/ig) != null){ //全角 
					len += 2; 
			   }else{
					len += 1;
				}			
			}
			if(len > 120){
				_alert(1,alert_title,"描述过长",$('#RptMemo'));
				return false;
			}
			//rpt_json.RptMemo = "B64:" + window.btoa(RptMemo);
						//rpt_json.RptMemo = "B64:" + encode64(RptMemo);
			rpt_json.RptMemo = RptMemo;
		}

		var RptSugg = $("#RptSugg").val(); //需要base64加密
		if (RptSugg != ""){
			var len = 0;
			for (var i = 0; i < RptSugg.length; i++) {
			   if (RptSugg.charAt(i).match(/[\u4E00-\u9FA5]/ig) != null){ //全角 
					len += 2; 
			   }else{
					len += 1;
				}			
			}
			if(len > 120){
				_alert(1,alert_title,"建议过长",$('#RptSugg'));
				return false;
			}
			//rpt_json.RptSugg = "B64:" + window.btoa(RptSugg);
			//rpt_json.RptSugg = "B64:" + encode64(RptSugg);
			rpt_json.RptSugg = RptSugg;
		}
		
		var DataFormat = $("#DataFormat").val();
		rpt_json.RptFormat.DataFormat = DataFormat;
		
		var RptLoad = $("#RptLoad").val();
		rpt_json.RptLoad = RptLoad;
		
		var graphic_report = $("#graphic_report").next('div').find('span.bb-switch-text').text();
		var text_report = $("#text_report").next('div').find('span.bb-switch-text').text();
		var chart_v = "";
		var layer_v = "";
		if (graphic_report == "生成"){
			chart_v = "chart";
		}else{
			chart_v = "chart-";
		}
		if (text_report == "生成"){
			layer_v = "layer";
		}else{
			layer_v = "layer-";
		}
		rpt_json.RptCont = "catalog|abstract|"+chart_v+"|"+layer_v;
		
		//var KeyLogType = $("#log_attribute").find('input[type=checkbox]:checked').val();
		var KeyLogType = "";
		$("#log_attribute").find('input[type=checkbox]').each(function(){
			if ($(this).prop('checked')){
				KeyLogType = KeyLogType + $(this).val() + ',';
			}
		});
		if (KeyLogType != ""){
			rpt_json.SearchDef.KeyLogType = KeyLogType.substring(0,KeyLogType.length-1);
		}
		/*
		var check_r = check_step2();
		if (check_r == false){
			return false;
		}
		*/
		rpt_json.RptCond = [];
		rpt_json.SearchDef.KeyRule.KeyCondition = [];
		$("#trList").children("tr[style*='display: table-row']").each(function(){
			var rptcond = {"field":"0","index":"1","name":"","datatype":""};
			var field = $(this).attr('field');
			var index = $(this).attr('index');
			var selectop = $(this).find("select:first").val();
			var action = "";
			var child_value;
			var $_tr = $(this);
			var datatype = $(this).data('type');
			var name = $(this).children('td:eq(0)').text();

			if (selectop == 0){
				return true;
			}else if (selectop == 1){//默认
				action = $(this).find('select:eq(1)').val();
				child_value = [];
				var $_td3 = $(this).children('td:eq(3)');
				switch(action){
					case "ingroup":
						$_td3.find('div.bb-sel-item').each(function(i,item){
							var v_id = $(item).find('input').attr('group');
							if (v_id != "" && v_id != undefined){
								var v = $(item).find('input').val();
								child_value.push(v_id+':'+v);
								return true;
							}
						});
						break;
					case "equal":
					case "not equal":
					case "high":
					case "ehigh":
					case "low":
					case "elow":
					case "begin":
					case "end":
					case "include":
					case "not include":
					case "regx":
					case "not regx":
					case "ncregx":
					case "not ncregx":
					case "match":
						if (datatype == 'ip'){
							$_td3.find('div.bb-sel-item').each(function(i,item){
								var v = $(item).find('input').val();
								var v1 = $(item).find('select').val();
								if (v != ""){
									child_value.push(v);
									return true;
								}
								if (v1 != "0"){
									child_value.push(v1);
									return true;
								}
							});
						}else if(datatype == "select"){
							$_td3.find('div.bb-sel-item').each(function(i,item){
								var op_v = $(item).find('select').val();
								var v = $(item).find('select').children('option:selected').text();
								child_value.push(op_v + ':' + v);
							});
						}else{
							$_td3.children('div').children('div').each(function(){
								if (datatype == 'time'){
									var ytd_v = $(this).find('input:eq(0)').val();
									var h_v = $(this).find('input:eq(1)').val();
									var m_v = $(this).find('input:eq(2)').val();
									var s_v = $(this).find('input:eq(3)').val();
									var v = ytd_v + ' ' + h_v + ':' + m_v + ':' + s_v;
								}else{
									var v = $(this).find('input').val();
								}
								
								if (v != ""){
									child_value.push(v);
								}
							});
						}
						break;
					case "between":
					case "span":
					case "ehspan":
					case "elspan":
						$_td3.children('div').children('div').each(function(){
							var f_v = $(this).find('input:eq(0)').val();
							var l_v = $(this).find('input:eq(1)').val();
							var data_type = $_tr.data('type');
							if (data_type == 'time'){
								var ytd_f_v = $(this).find('input:eq(0)').val();
								var h_f_v = $(this).find('input:eq(1)').val();
								var m_f_v = $(this).find('input:eq(2)').val();
								var s_f_v = $(this).find('input:eq(3)').val();
								var f_v = ytd_f_v + ' ' + h_f_v + ':' + m_f_v + ':' + s_f_v;
								var ytd_l_v = $(this).find('input:eq(4)').val();
								var h_l_v = $(this).find('input:eq(5)').val();
								var m_l_v = $(this).find('input:eq(6)').val();
								var s_l_v = $(this).find('input:eq(7)').val();
								var l_v = ytd_l_v + ' ' + h_l_v + ':' + m_l_v + ':' + s_l_v;
								if (f_v != "" && l_v !=""){
									child_value.push(f_v+';'+l_v);
								}
								
							}else if (data_type == 'ip'){
								if (f_v != "" && l_v != ""){
									child_value.push(f_v+';'+l_v);
								}
							}else{
								var _section = [];
								if (f_v != "" && l_v != ""){
									_section.push(f_v);
									_section.push(l_v);
									child_value.push(_section);
								}
								
							}
						});
						break;
					default:
						child_value = [];
				}
			}else{
				child_value = "";
				rptcond.field = field;
				rptcond.index = index;
				rptcond.datatype = datatype;
				rptcond.name = name.substring(0,name.length-1);
				rpt_json.RptCond.push(rptcond);
				//rpt_json.RptCond.push(field+'.'+index);
			}
			var KeyCondition_child = {"child":false,"field":0,"index":0,"selectop":"0","action":"","value":"","name":"","type":""};
			KeyCondition_child.field = field;
			KeyCondition_child.index = index;
			KeyCondition_child.selectop = selectop;
			KeyCondition_child.action = action;
			KeyCondition_child.value = child_value;
			KeyCondition_child.name = name.substring(0,name.length-1);
			KeyCondition_child.type = datatype;
			rpt_json.SearchDef.KeyRule.KeyCondition.push(KeyCondition_child);
		});
		
		if (!$("#QY4").prop('checked')){
			var check3_r = check_step(3,$("#trList2"),$("#trList4"),$("#trList3"));
			if (check3_r == false){
				return false;
			}
		}
		var save_flag = true;
		save_flag = save_report($("#trList2"),$("#trList3"),$("#trList4"),3);
		if (!save_flag){
			return false;
		}
		if ($("#QY4").prop('checked')){
			var check4_r = check_step(4,$("#trList5"),$("#trList7"),$("#trList6"));
			if (check4_r == false){
				return false;
			}
			save_flag = save_report($("#trList5"),$("#trList6"),$("#trList7"),4);
			if (!save_flag){
				return false;
			}
		}
		
		temp_json.Id = temp_id;
		temp_json.Name = RptName;
		temp_json.UserCode = usercode;
		temp_json.Condition = JSON.stringify(rpt_json);
		temp_json.TemplateTypeId = parseInt(Rpmember_id);
		msstr = aceg(JSON.stringify(temp_json),se);
		$.ajax({
			url:'/bhost/Save_DataReportTemplate',
			type:'post',
			async:false,
			data:{a0:se,z1:JSON.stringify(temp_json),z2:back_type,m1:msstr},
			success:function(result){
				var save_result = JSON.parse(result);
				if (save_result.Result){
					if (temp_id == 0){
						//parent._errLayer('保存成功',"添加模板");
						//_alert(0,"添加模板","保存成功");
						var title = "添加模板";
					}else{
						//parent._errLayer('保存成功',"修改模板");
						//_alert(0,"修改模板","保存成功");
						var title = "修改模板";
					}
					
					parent.layer.open({
						type: 1,
						title: title,
						content: '<div class="layer-alert"><i class="alert succ"></i>保存成功</div>',
						btn: '确&nbsp;&nbsp;定',
						btnAlign: 'c',
						area: ['380px', '310px'],
						skin: 'layer-custom',
						scrollbar: false,
						btn1:function(i){
							parent.layer.close(i);
							if (temp_id == 0){
								if (back_type == 0){
									var con_url = '/bhost/modify_template?se='+{{se}}+'&z1=0&z2=0';
									var mod_url = '/bhost/modify_template?se='+{{se}}+'&z1=0&z2='+save_result.Id;
								}else{
									var con_url = '/bhost/report_condition?se='+se+'&z2=' + save_result.Id;
									var mod_url = '/bhost/modify_template?se='+se+'&z2=' + save_result.Id;
								}
																																									if (parent.$('div.bb-menu2').children('ul').length == 1){
									if (rpt_json.RpmemberId == parent.$('div.bb-menu').find('li.active').attr('id').split('-')[1]){
										parent.$('div.bb-menu2').removeClass('bb-blank');
										parent.$('div.bb-menu2').children('ul').append('<li data-url="'+con_url+'"><span class="tit">'+RptName+'</span><div class="ctr"><a href="javascript:;" class="edit" data-url="'+mod_url+'"></a><a href="javascript:;" class="del" onclick="_delItem(this,'+save_result.Id+')"></a></div></li>');
									}
								}else{
									if (rpt_json.RpmemberId == parent.$('div.bb-menu').find('li.active').attr('id').split('-')[1]){
										parent.$('div.bb-menu2').children('ul').append('<li data-url="'+con_url+'"><span class="tit">'+RptName+'</span><div class="ctr"><a href="javascript:;" class="edit" data-url="'+mod_url+'"></a><a href="javascript:;" class="del" onclick="_delItem(this,'+save_result.Id+')"></a></div></li>');
									}
								}
							}else{
								if (classify_id == rpt_json.RpmemberId){
									if (RptName != edit_name){
										parent.$("div.bb-menu2").find('li.active').find('span').text(RptName);
									}
								}else{
									if (parent.$("div.bb-menu2").find('li.active').text() == edit_name){
										parent.$("div.bb-menu2").find('li.active').remove();
									}
								}
							}
							//console.log(parent.$('div.bb-menu2').find('li').length);
							if (parent.$('div.bb-menu2').find('li').length == 0){
								//console.log("1111111");
								parent.$('div.bb-menu').find('li.active').children('span').trigger('click');
							}else{
								if(parent.$('div.bb-menu2').find('li.active').length == 0){
									parent.$('div.bb-menu2').find('li:first>span').trigger('click');
								}else{
									parent.$('div.bb-menu2').find('li.active>span').trigger('click');
								}
							}
						}
					});	
					return false;
				}else{
					if (temp_id == 0){
						var title = "添加模板";
					}else{
						var title = "修改模板";
					}
					var err_result = save_result.ErrMsg;
					parent.layer.open({
						type: 1,
						title: title,
						content: '<div class="layer-alert"><i class="alert fail"></i>'+err_result+'</div>',
						btn: '确&nbsp;&nbsp;定',
						btnAlign: 'c',
						area: ['380px', '310px'],
						skin: 'layer-custom',
						scrollbar: false,
						btn1:function(i){
							parent.layer.close(i);
						}
					});
					return false;
				}
			}
		});
    }
	
	function back(){
		if (back_type == 0 && temp_id == 0){
			parent.location.href='/bhost/index?tasktype=2&se='+se+'&us='+window.parent.parent.frm.us.value;
		}else{
			if (parent.$('div.bb-menu2').find('li').length == 0){
				parent.$('div.bb-menu').find('li.active>span').click();
			}else{
				parent.$('div.bb-menu2').find('li.active>span').click();
			}
		}
		
		//parent.$('div.bb-menu2').find('li:first>span').click();
		//window.history.back(-1);
	}
	function clear_template(){
		$("#bbCont").find('input[type=text]').val('');
	}
	
	function change_order(obj){
		var c = $(obj).val();
		if(c == -1){
			$(obj).siblings("select").empty().append("<option value=\"-1\">---</option>")
		}else{
			$(obj).siblings("select").empty().append("<option value=\"0\" selected=\"selected\">升序</option><option value=\"1\">降序</option>")
		}
	}
	
	function save_report(obj1,obj2,obj3,type){
		var layer_json = {"level":1,"style":"stat","template":"默认","page":"","expand":false,"groupstat":[],"config":[]}
		if (type == 3){
			layer_json.level = 1;
		}else{
			layer_json.level = 2;
		}
		var report_type = $("#Step"+type).find('.btype').children('a.active').text();
		if (report_type == "统计型报表"){
			layer_json.style = "stat";
		}else{
			layer_json.style = "detail";
		}
		var templateselect = $("#Step"+type).find('.br').find('select').val();
		layer_json.template = templateselect;
		var page = $("#Step"+type).find('.br').find('input').val();
		layer_json.page = page;
		if (type == 3){
			if ($("#QY4").prop('checked')){
				layer_json.expand = true;
			}else{
				layer_json.expand = false;
			}
		}else{
			layer_json.expand = false;
		}
		var error_flag = 0;
		if (report_type == "统计型报表"){
			$(obj1).children('tr').each(function(){
				var $_td1 = $(this).children('td:eq(1)');
				var $_td2 = $(this).children('td:eq(2)');
				if (!$_td1.find('input').prop('checked') && $_td2.find('select:eq(0)').val() == 0){
					return true;
				}
				
				var groupstat = {"Field":"0","Index":"0","Grouped":"false","GroupUnit":"","GroupIndex":"0","GroupInnerIndex":"1","StatMethod":"0","Name":""};
				var Name = $(this).children('td:eq(0)').text();
				var Field = $(this).attr("field");
				var Index = $(this).attr("index");
				var Grouped;
				if ($_td1.find('input').prop('checked')){
					Grouped = "true";
				}else{
					Grouped = "false";
				}
				var GroupUnit = "";
				if ($_td1.find('select').length != 0){
					GroupUnit = $_td1.find('select').val();
				}
				var GroupIndex = $_td2.find('select:eq(0)').val();
				var GroupInnerIndex = $_td2.find('select:eq(1)').val();
				var StatMethod = 0;
				if ($_td2.find('input').length != 0 && $_td2.find('.tjWrap2').attr('style') == "display: block;"){
					$_td2.find('.tjWrap2').children('label').each(function(i,item){
						var $_input = $(item).find('input');
						if ($_input.prop('checked')){
							StatMethod  = StatMethod + parseInt($_input.val());
						}
					});
				}
				groupstat.Name = Name.substring(0,Name.length-1);
				groupstat.Field = Field;
				groupstat.Index = Index;
				groupstat.Grouped = Grouped;
				groupstat.GroupUnit = GroupUnit;
				groupstat.GroupIndex = GroupIndex;
				groupstat.GroupInnerIndex = GroupInnerIndex;
				groupstat.StatMethod = StatMethod.toString();
				layer_json.groupstat.push(groupstat);
			});
			
			$(obj2).children('tr').each(function(){
				var config_json = {"GroupIndex":1,"Sort":64,"Sorttrue":true,"StatValueShow":false,"Split":false,"Lascande":false,"ShowFilter":{"opened":false,"top":0,"bottom":0,"max":false,"min":false},"Condition":{"opened":false,"type":false,"ConditionType":0,"action":"","value":[]}}
				var GroupIndex = $(this).attr('id').substring(4);
				var $_td2 = $(this).children('td:eq(2)');
				var Sort = $_td2.find('select:eq(0)').val();
				var Sorttrue;
				if (Sort == -1){
					Sorttrue = "-1";
				}else{
					if ($_td2.find('select:eq(1)').val() == 0){
						Sorttrue = true;
					}else{
						Sorttrue = false;
					}
				}
				if ($_td2.find('input[type=checkbox]:eq(0)').prop('checked')){ //显示计数值
					StatValueShow = true;
				}else{
					StatValueShow = false;
				}
				if ($_td2.find('input[type=checkbox]:eq(1)').prop('checked')){ //拆分
					Split = true;
				}else{
					Split = false;
				}
				if ($_td2.find('input[type=checkbox]:eq(2)').prop('checked')){ //横向扩展
					Lascande = true;
				}else{
					Lascande = false;
				}
				if ($_td2.find('input[type=checkbox]:eq(3)').prop('checked')){ //显示过滤
					config_json.ShowFilter.opened = true;
					var check_flag = 0;
					if ($_td2.find('input[type=checkbox]:eq(4)').prop('checked')){//前
						var top_v = $_td2.find('.ss.ss2:eq(0)').find('input[type=text]:eq(0)').val();
						if (top_v == ""){
							error_flag = 1;
							_alert(2,alert_title,"请配置完整显示过滤",$_td2.find('.ss.ss2:eq(0)').find('input[type=text]:eq(0)'));
							return false;
						}else{
							if (!numReg.test(top_v)){
								error_flag = 1;
								_alert(2,alert_title,"请输入数字",$_td2.find('.ss.ss2:eq(0)').find('input[type=text]:eq(0)'));
								return false;
							}
							config_json.ShowFilter.top = top_v;
						}
					}else{
						check_flag++;
					}
					if ($_td2.find('input[type=checkbox]:eq(5)').prop('checked')){ //后
						var bottom_v = $_td2.find('.ss.ss2:eq(0)').find('input[type=text]:eq(1)').val();
						if (bottom_v == ""){ 
							error_flag = 1;
							_alert(2,alert_title,"请配置完整显示过滤",$_td2.find('.ss.ss2:eq(0)').find('input[type=text]:eq(1)'));
							return false;
						}else{
							if (!numReg.test(bottom_v)){
								error_flag = 1;
								_alert(2,alert_title,"请输入数字",$_td2.find('.ss.ss2:eq(0)').find('input[type=text]:eq(1)'));
								return false;
							}
							config_json.ShowFilter.bottom = bottom_v;
						}
					}else{
						check_flag++;
					}
					if ($_td2.find('input[type=checkbox]:eq(6)').prop('checked')){ //最大值
						config_json.ShowFilter.max = true;
					}else{
						config_json.ShowFilter.max = false;
						check_flag++;
					}
					if ($_td2.find('input[type=checkbox]:eq(7)').prop('checked')){ //最小值
						config_json.ShowFilter.min = true;
					}else{
						config_json.ShowFilter.min = false;
						check_flag++;
					}
					if (check_flag == 4){
						error_flag = 1;
						_alert(2,alert_title,"请配置完整显示过滤");
						return false;
					}
				}else{
					config_json.ShowFilter.opened = false;
				}
				
				if ($_td2.find('input[type=checkbox]:eq(8)').prop('checked')){ //统计过滤
					config_json.Condition.opened = true;
					config_json.Condition.type = true;
					if ($_td2.find('.ss.ss2:eq(1)').find('span:eq(0)').css('display') == "none"){
						config_json.Condition.ConditionType = 1;
					}else{
						config_json.Condition.ConditionType = 0;
					}
					/*
					if ($_td2.find('select').length == 3){
						config_json.Condition.ConditionType = 0;
					}else{
						config_json.Condition.ConditionType = 1;
					}
					*/
					var action = $_td2.find('.ss.ss2:eq(1)').find('select:eq(1)').val();
					config_json.Condition.action = action;
					var value_arry = [];
					var filter_v = $_td2.find('.ss.ss2:eq(1)').find('input').val();
					if (filter_v == ""){
						error_flag = 1;
						_alert(2,alert_title,"请配置完整统计过滤",$_td2.find('.ss.ss2:eq(1)').find('input'));
						return false;
					}
					if (!numReg.test(filter_v)){
						error_flag = 1;
						_alert(2,alert_title,"请输入数字",$_td2.find('.ss.ss2:eq(1)').find('input'));
						return false;
					}
					value_arry.push(parseInt(filter_v));
					config_json.Condition.value = value_arry;
				}
				config_json.GroupIndex = GroupIndex;
				config_json.Sort = Sort;
				config_json.Sorttrue = Sorttrue;
				config_json.StatValueShow = StatValueShow;
				config_json.Split = Split;
				config_json.Lascande = Lascande;
				layer_json.config.push(config_json);
			});
			if (error_flag == 1){
				return false;
			}
			rpt_json.RptBuild.layer.push(layer_json);
		}else{
			$(obj3).children('tr').each(function(){
				var $_td1 = $(this).children('td:eq(1)');
				var $_td2 = $(this).children('td:eq(2)');
				var groupstat = {"field":"0","Index":"0","show":"true","GroupIndex":"1","Name":""};
				var field = $(this).attr("field");
				var Index = $(this).attr("index");
				var show;
				if ($_td1.find('input').prop('checked')){
					show = "true";
				}else{
					return true;
					//show = "false";
				}
				var GroupIndex = $_td2.find('select:eq(0)').val();
				var Name = $(this).children('td:eq(0)').text();
				groupstat.field = field;
				groupstat.Index = Index;
				groupstat.show = show;
				groupstat.GroupIndex = GroupIndex;
				groupstat.Name = Name.substring(0,Name.length-1);
				layer_json.groupstat.push(groupstat);
			});
			if (layer_json.groupstat.length == 0){
				_alert(2,alert_title,"请至少设置一个显示位置");
				return false;
			}
			layer_json.config = [];
			rpt_json.RptBuild.layer.push(layer_json);
		}
		return true;
	}
	function _setDeAddr(obj){
        var v = $(obj).val();
        var $c = $(obj).parents('div.bb-sel-item').children('input');

        if(v == 0 || v == '0'){
            $c.show();
            $(obj).next('.select2').removeClass('bb-sel-sg');
        }else{
            $c.hide();
             $(obj).next('.select2').addClass('bb-sel-sg');
        }
    }
	
	function _getHostGroup(obj){
        parent.__getHostGroup();

        $_hostGroupObj = $(obj);
    }
	
	function __setHostGroup(data){
        _setHostGroup(data,$_hostGroupObj)
    }
	
	function _setHostGroup(data,obj){
        var $_p = obj.parents('div.bb-sel-cont');
        var hgIds = new Array();
        $('input.forgroup:visible',$_p).each(function(){
            var hgid = $(this).attr('group');
            if(hgid){
                hgIds.push(parseInt(hgid));
            }
        })
		var isexist = 0;
		$.each(data,function(i,item){
			var path = item.path.split('/');
			$.each(path,function(i2,item2){
				if ($.inArray(parseInt(item2),hgIds) != -1){
					isexist = 1;
					return false;
				}
			});
			if (isexist == 0){
				var $_c = $(obj).parents('div.bb-sel-item').clone();
                $_p.append($_c);
                $_c.find('input.forgroup').val(item.name).attr('group',item.id).attr('title',item.name);
			}
		});
		/*
        $.each(data,function(i,item){
            if($.inArray(item.id,hgIds) < 0){
                var $_c = $(obj).parents('div.bb-sel-item').clone();
                $_p.append($_c);
                $_c.find('input.forgroup').val(item.name).attr('group',item.id).attr('title',item.name);
            }
        })
		*/

        parent._closeHgLayer();
    }
	
	function _compare_ip(x, y) {
		var ip1 = x.split('.');
		var ip2 = y.split('.');
		for (var i1 = 0; i1 < 4; i1++) {
			if (parseInt(ip1[i1]) < parseInt(ip2[i1])) {
				return 3;
			} else if (parseInt(ip1[i1]) > parseInt(ip2[i1])) {
				return 2
			} else {

			}
		}
		return 1
	}
	
	function _compare_time(begin,end){
		 var d1 = new Date(begin.replace(/\-/g, "\/"));
		 var d2 = new Date(end.replace(/\-/g, "\/"));  

		 if(d1 >d2){  
			return 1;
		 }
		 return 0;
	}
	
	function change_filter(obj){
		var change_f = 0;
		if (!$(obj).prop('checked')){
			$(obj).parent().siblings('label').each(function(i,item){
				if ($(item).find('input').prop('checked')){
					change_f = 1;
					return false;
				}
			});
			if (change_f == 0){
				$(obj).iCheck('check').trigger('change');
				return false;
			}
		}
		
		var opt_str = "";
		$(obj).parents('.tjWrap2').find('input').each(function(i,item){
			var c_t = $(item).parent().text();
			var c_v = $(item).val();
			if (c_v == 4){
				return true;
			}
			if ($(item).prop('checked')){
				opt_str = opt_str + '<option value="'+c_v+'">'+c_t+'</option>';
			}
		});
		var list_id = parseInt($(obj).parents('tbody').attr('id').substr(6)) + 1;
		$("#trList"+list_id).children('#pzTr'+$(obj).parents('td').find('select').val()).children('td:eq(2)').children('.ss:eq(4)').find('select:eq(0)').empty().append(opt_str);
	}
    </script>
</body>

</html>
